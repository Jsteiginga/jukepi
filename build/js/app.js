!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.jukePi=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){var Mopidy=_dereq_("mopidy");var Handlebars=_dereq_("handlebars/runtime").default;var LastFM=_dereq_("browserified-lastfm-api");var Router=_dereq_("./router.js");var RootView=_dereq_("./view/page/root.js");var NavigationView=_dereq_("./view/page/navigation.js");var AlertView=_dereq_("./view/modal/alert.js");var extend=_dereq_("backbone/node_modules/underscore").extend;var history=_dereq_("backbone").history;var env=_dereq_("./env.json");function jukePi(config,callback){var mopidy;var lastfm;var router;var rootView;var rootViewEl;var routerViewEl;var navigationViewEl;var loadingAlert;config=extend({},env,config);mopidy=!config.mopidyWebSocketUrl?new Mopidy({callingConvention:"by-position-only"}):new Mopidy({webSocketUrl:config.mopidyWebSocketUrl,callingConvention:"by-position-only"});lastfm=new LastFM({apiKey:config.lastfm.key,apiSecret:config.lastfm.secret});rootViewEl=document.getElementById("root_view");routerViewEl=document.getElementById("primary_router_view");navigationViewEl=document.getElementById("navigation_view");mopidy.once("state:online",function(){var router=new Router({mopidy:mopidy,lastfm:lastfm,config:config,rootElement:routerViewEl});var navigation=new NavigationView({router:router,mopidy:mopidy,config:config,lastfm:lastfm});var view=new RootView({router:router,mopidy:mopidy,config:config,lastfm:lastfm});loadingAlert=new AlertView({header:"Loading",message:new Handlebars.SafeString(_dereq_("../templates/modal/loading.hbs")())});document.body.appendChild(loadingAlert.render().el);function storeUriSchemes(uriSchemes){config.uriSchemes=uriSchemes}function start(){navigationViewEl.appendChild(navigation.render().el);rootViewEl.appendChild(view.render().el);history.start(true);if(typeof callback==="function"){callback(null,{mopidy:mopidy})}window.config=config}mopidy.getUriSchemes().then(storeUriSchemes).then(start)});mopidy.once("state:online",function(){loadingAlert.remove()});mopidy.on("state:offline",function(){})}module.exports=jukePi},{"../templates/modal/loading.hbs":101,"./env.json":7,"./router.js":14,"./view/modal/alert.js":30,"./view/page/navigation.js":40,"./view/page/root.js":41,backbone:"5kFNoY","backbone/node_modules/underscore":48,"browserified-lastfm-api":50,"handlebars/runtime":67,mopidy:88}],2:[function(_dereq_,module,exports){var Collection=_dereq_("./collection.js");var Album=_dereq_("../model/album.js");var AlbumCollection=Collection.extend({model:Album});module.exports=AlbumCollection},{"../model/album.js":8,"./collection.js":4}],3:[function(_dereq_,module,exports){var Collection=_dereq_("./collection.js");var Artist=_dereq_("../model/artist.js");var ArtistCollection=Collection.extend({model:Artist});module.exports=ArtistCollection},{"../model/artist.js":9,"./collection.js":4}],4:[function(_dereq_,module,exports){var Backbone=_dereq_("backbone");var Collection=Backbone.Collection.extend({initialize:function(models,options){Backbone.Collection.prototype.initialize.call(this,models,options);if(options.mopidy){this.mopidy=options.mopidy}if(options.lastfm){this._lastfm=options.lastfm}},move:function(model,toIndex){var fromIndex=this.indexOf(model);if(fromIndex===-1){throw new Error("Can't move a model that's not in the collection")}if(fromIndex!==toIndex){this.models.splice(toIndex,0,this.models.splice(fromIndex,1)[0])}this.trigger("sort")},modelAttributes:function(){return this.map(this._modelAttributes.bind(this))},_modelAttributes:function(model){return modelAttributes}});module.exports=Collection},{backbone:"5kFNoY"}],5:[function(_dereq_,module,exports){var Collection=_dereq_("./collection.js");var Track=_dereq_("../model/track.js");var TrackCollection=Collection.extend({model:Track});module.exports=TrackCollection},{"../model/track.js":12,"./collection.js":4}],6:[function(_dereq_,module,exports){var extend=_dereq_("backbone/node_modules/underscore").extend;var Collection=_dereq_("./collection.js");var TrackListTrack=_dereq_("../model/track_list_track.js");var TrackListCollection=Collection.extend({model:TrackListTrack,_resyncCounter:0,_prepareModel:function(attrs,options){var opts=extend({},options,{mopidy:this.mopidy});return Collection.prototype._prepareModel.call(this,attrs,opts)},initialize:function(models,options){Collection.prototype.initialize.apply(this,arguments);this.listenTo(this.mopidy,"event:tracklistChanged",this.fetch)},move:function(model,toIndex){var modelIndex=this.indexOf(model);Collection.prototype.move.apply(this,arguments);this.mopidy.tracklist.move(modelIndex,modelIndex+1,toIndex).then(null,Collection.prototype.move.bind(this,model,modelIndex))},sync:function(method,collection,options){var xhr=this.mopidy.tracklist.getTlTracks();function tlTracksSuccess(resp){options.success(resp)}this.mopidy.playback.getCurrentTlTrack().then(function(track){track=track||{};options.activeTlid=track.tlid;xhr.then(tlTracksSuccess)});return xhr},current:function(){return this.filter(function(tlTrack){return tlTrack.current})[0]}});module.exports=TrackListCollection},{"../model/track_list_track.js":13,"./collection.js":4,"backbone/node_modules/underscore":48}],7:[function(_dereq_,module,exports){module.exports={title:"JukePi",mopidyWebSocketUrl:null,lastfm:{key:null,secret:null}}},{}],8:[function(_dereq_,module,exports){var extend=_dereq_("backbone/node_modules/underscore").extend;var Model=_dereq_("./model.js");var Album=Model.extend({idAttribute:"uri",initialize:function(attributes,options){if(!options.collection){var TrackCollection=_dereq_("../collection/track.js");var Artist=_dereq_("./artist.js");Model.prototype.initialize.call(this,attributes,options);this.tracks=new TrackCollection(null,{mopidy:this.mopidy,lastfm:this._lastfm});this.artist=new Artist(null,{mopidy:this.mopidy,lastfm:this._lastfm})}},toJSON:function(){var modelData=Model.prototype.toJSON.call(this);if(this.artist){modelData.artist=this.artist.toJSON()}return modelData},sync:function(method,model,options){function modelSuccess(resp){options.success(resp.album)}function tracksSuccess(resp){var tracks;var artist;if(resp[0]&&resp[0].album){tracks=resp;artist=resp[0].album.artists[0];model.tracks.set(tracks);model.artist.set(artist)}}this.mopidy.library.lookup(this.id).then(tracksSuccess);this._lastfm.album.getInfo({artist:this.get("artist"),album:this.get("title")},{success:modelSuccess})}});module.exports=Album},{"../collection/track.js":5,"./artist.js":9,"./model.js":10,"backbone/node_modules/underscore":48}],9:[function(_dereq_,module,exports){var _=_dereq_("backbone/node_modules/underscore");var Model=_dereq_("./model.js");var Artist=Model.extend({idAttribute:"uri",initialize:function(attributes,options){if(!options.collection){var TrackCollection=_dereq_("../collection/track.js");var AlbumCollection=_dereq_("../collection/album.js");Model.prototype.initialize.apply(this,arguments);this.tracks=new TrackCollection(null,{mopidy:this.mopidy,lastfm:this._lastfm});this.albums=new AlbumCollection(null,{mopidy:this.mopidy,lastfm:this._lastfm})}},sync:function(method,model,options){var artistUri=this.id;var artistName=this.get("name");function lookupSuccess(tracks){var _tracks;tracks=tracks||[];_tracks=_(tracks.filter(function(track){return!track.name.match(/^\[unplayable\]/)}));var albums=_tracks.chain().pluck("album").uniq(false,function(album){return album.uri}).value();var artist=_tracks.chain().map(function(track){return track.artists}).flatten().uniq(false,function(artist){return artist.uri}).find(function(artist){return artist.uri===artistUri}).value()||{uri:artistUri,name:artistName};model.tracks.set(tracks);model.albums.set(albums)}function lastfmSuccess(resp){options.success(resp.artist)}this.mopidy.library.lookup(this.id).then(lookupSuccess);this._lastfm.artist.getInfo({artist:artistName},{success:lastfmSuccess,error:options.error})}});module.exports=Artist},{"../collection/album.js":2,"../collection/track.js":5,"./model.js":10,"backbone/node_modules/underscore":48}],10:[function(_dereq_,module,exports){var Backbone=_dereq_("backbone");var Model=Backbone.Model.extend({initialize:function(attributes,options){Backbone.Model.prototype.initialize.call(this,attributes,options);options=options||{};this.mopidy=options.mopidy;this._config=options.config;this._lastfm=options.lastfm}});module.exports=Model},{backbone:"5kFNoY"}],11:[function(_dereq_,module,exports){var Model=_dereq_("./model.js");var TrackCollection=_dereq_("../collection/track.js");var AlbumCollection=_dereq_("../collection/album.js");var ArtistCollection=_dereq_("../collection/artist.js");var Search=Model.extend({collections:{},initialize:function(attributes,options){Model.prototype.initialize.call(this,attributes,options);this.tracks=new TrackCollection(null,{mopidy:this.mopidy,lastfm:this._lastfm});this.albums=new AlbumCollection(null,{mopidy:this.mopidy,lastfm:this._lastfm});this.artists=new ArtistCollection(null,{mopidy:this.mopidy,lastfm:this._lastfm})},sync:function(method,model,options){var success=options.success;var timestamp=Date.now();var searchUris=this._config&&this._config.searchUris&&this._config.searchUris.length?this._config.searchUris:null;var mopidy=this.mopidy;this._searchTimestamp=timestamp;options.success=function(resp){if(timestamp===this._searchTimestamp){this._syncResponseToCollections(resp);success(model,resp,options)}}.bind(this);function appendColons(s){return s+":"}function escapeRegex(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function isLookup(uriSchemes){var uriMatch=new RegExp("^("+uriSchemes.join("|")+"):(?:\\/\\/((?:(?=((?:[a-z0-9-._~!$&'()*+,;=:]|%[0-9A-F]{2})*))(\\3)@)?(?=(\\[[0-9A-F:.]{2,}\\]|(?:[a-z0-9-._~!$&'()*+,;=]|%[0-9A-F]{2})*))\\5(?::(?=(\\d*))\\6)?)(\\/(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/]|%[0-9A-F]{2})*))\\8)?|(\\/?(?!\\/)(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/]|%[0-9A-F]{2})*))\\10)?)(?:\\?(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/?]|%[0-9A-F]{2})*))\\11)?(?:#(?=((?:[a-z0-9-._~!$&'()*+,;=:@\\/?]|%[0-9A-F]{2})*))\\12)?$","i");return uriMatch.test(options.query)}function decorateResult(result){return[{tracks:result}]}function doSearch(isLookup){if(isLookup){return mopidy.library.lookup(options.query).then(decorateResult,options.error).then(options.success,options.error)}return mopidy.library.search({any:[options.query]},searchUris.map(appendColons)).then(options.success,options.error)}return this.mopidy.getUriSchemes().then(isLookup).then(doSearch)},_searchTimestamp:0,_syncResponseToCollections:function(resp){function extractResultsByKey(key,results){return results.map(function(r){return r[key]||[]}).reduce(function(a,b){return a.concat(b)})}var tracks=extractResultsByKey("tracks",resp);var albums=extractResultsByKey("albums",resp);var artists=extractResultsByKey("artists",resp);if(tracks&&tracks.length){this.tracks.set(tracks)}else{this.tracks.reset()}if(albums&&albums.length){this.albums.set(albums)}else{this.albums.reset()}if(artists&&artists.length){this.artists.set(artists)}else{this.artists.reset()}}});module.exports=Search},{"../collection/album.js":2,"../collection/artist.js":3,"../collection/track.js":5,"./model.js":10}],12:[function(_dereq_,module,exports){var extend=_dereq_("backbone/node_modules/underscore").extend;var Model=_dereq_("./model.js");var Track=Model.extend({idAttribute:"uri",sync:function(method,model,options){function lastfmSuccess(resp){var data=extend({},this.attributes,resp);options.success(data)}if(method==="update"){xhr=this.mopidy.tracklist.add([model]);xhr.then(options.success,options.error)}else{model._lastfm.album.getInfo({artist:this.attributes.artists[0].name,album:this.attributes.album.name},{success:lastfmSuccess,error:options.error})}}});module.exports=Track},{"./model.js":10,"backbone/node_modules/underscore":48}],13:[function(_dereq_,module,exports){var Model=_dereq_("./model.js");var Track=_dereq_("./track.js");var TrackListTrack=Model.extend({idAttribute:"tlid",current:false,initialize:function(attributes,options){Model.prototype.initialize.call(this,attributes,options);options=options||{};this.current=attributes.tlid===options.activeTlid;this.track=new Track(attributes.track,{mopidy:this.mopidy,lastfm:this._lastfm});this._initListeners()},_initListeners:function(){var trackPlaybackStartedCallback=this._onTrackPlaybackStarted.bind(this);this.mopidy.on("event:trackPlaybackStarted",trackPlaybackStartedCallback);this.on("remove",this.mopidy.off.bind(this.mopidy,"event:trackPlaybackStarted",trackPlaybackStartedCallback))},_onTrackPlaybackStarted:function(event){if(this.current!==(this.id===event.tl_track.tlid)){this.current=!this.current;this.trigger("change")}}});module.exports=TrackListTrack},{"./model.js":10,"./track.js":12}],14:[function(_dereq_,module,exports){var Backbone=_dereq_("backbone");var AlbumTabView=_dereq_("./view/tab/album.js");var ArtistTabView=_dereq_("./view/tab/artist.js");var SearchTabView=_dereq_("./view/tab/search.js");var Search=_dereq_("./model/search.js");var Router=Backbone.Router.extend({initialize:function(options){Backbone.Router.prototype.initialize.call(this,options);this._mopidy=options.mopidy;this._lastfm=options.lastfm;this._rootElement=options.rootElement;this._config=options.config},routes:{"":"dashboard","albums/:id/:artist/:name":"albums","artists/:uri/:name":"artists","search/:query":"search"},dashboard:function(){this.trigger("beforeRoute")},albums:function(id,artist,name){this.trigger("beforeRoute");var view=new AlbumTabView({router:this,mopidy:this._mopidy,lastfm:this._lastfm,config:this._config,id:id,name:name,artist:artist});this._rootElement.appendChild(view.render().el)},artists:function(uri,name){this.trigger("beforeRoute");var view=new ArtistTabView({router:this,mopidy:this._mopidy,lastfm:this._lastfm,config:this._config,uri:uri,name:name});this._rootElement.appendChild(view.render().el)},search:function(query){this.trigger("beforeRoute");var view=new SearchTabView({router:this,mopidy:this._mopidy,lastfm:this._lastfm,config:this._config,query:query,model:new Search(null,{mopidy:this._mopidy,config:this._config})});this._rootElement.appendChild(view.render().el)}});module.exports=Router},{"./model/search.js":11,"./view/tab/album.js":43,"./view/tab/artist.js":44,"./view/tab/search.js":45,backbone:"5kFNoY"}],15:[function(_dereq_,module,exports){var Handlebars=_dereq_("handlebars/runtime").default;var marked=_dereq_("marked");var templates={};marked.setOptions({gfm:true});Handlebars.registerHelper("markdown",function(options){var content=options.fn(this);return marked(content)});Handlebars.registerHelper("debug",function(options){console.log(this)});templates.tab_view=_dereq_("../templates/tab/view.hbs");templates.album_collection=_dereq_("../templates/album/collection.hbs");templates.album_item_model=_dereq_("../templates/album/item_model.hbs");templates.album_page=_dereq_("../templates/album/page.hbs");templates.album_model=_dereq_("../templates/album/model.hbs");templates.artist_collection=_dereq_("../templates/artist/collection.hbs");templates.artist_item_model=_dereq_("../templates/artist/item_model.hbs");templates.artist_link_model=_dereq_("../templates/artist/link_model.hbs");templates.artist_model=_dereq_("../templates/artist/model.hbs");templates.home_volume_control=_dereq_("../templates/home/volume_control.hbs");templates.home_search_control=_dereq_("../templates/home/search_control.hbs");templates.home_playback_control=_dereq_("../templates/home/playback_control.hbs");templates.nowplaying_view=_dereq_("../templates/nowplaying/view.hbs");templates.track_list=_dereq_("../templates/track/list.hbs");templates.track_collection=_dereq_("../templates/track/collection.hbs");templates.track_model_item=_dereq_("../templates/track/model_item.hbs");templates.tracklist_list=_dereq_("../templates/tracklist/list.hbs");templates.tracklist_collection=_dereq_("../templates/tracklist/collection.hbs");templates.tracklist_model=_dereq_("../templates/tracklist/model.hbs");module.exports=templates},{"../templates/album/collection.hbs":89,"../templates/album/item_model.hbs":90,"../templates/album/model.hbs":91,"../templates/album/page.hbs":92,"../templates/artist/collection.hbs":93,"../templates/artist/item_model.hbs":94,"../templates/artist/link_model.hbs":95,"../templates/artist/model.hbs":96,"../templates/home/playback_control.hbs":97,"../templates/home/search_control.hbs":98,"../templates/home/volume_control.hbs":99,"../templates/nowplaying/view.hbs":103,"../templates/tab/view.hbs":105,"../templates/track/collection.hbs":106,"../templates/track/list.hbs":107,"../templates/track/model_item.hbs":108,"../templates/tracklist/collection.hbs":109,"../templates/tracklist/list.hbs":110,"../templates/tracklist/model.hbs":111,"handlebars/runtime":67,marked:68}],16:[function(_dereq_,module,exports){var CollectionView=_dereq_("./view.js");var AlbumModelItemView=_dereq_("../model_item/album.js");var AlbumCollectionView=CollectionView.extend({template:"album_collection",itemViewClass:AlbumModelItemView});module.exports=AlbumCollectionView},{"../model_item/album.js":35,"./view.js":20}],17:[function(_dereq_,module,exports){var CollectionView=_dereq_("./view.js");var ArtistModelItemView=_dereq_("../model_item/artist.js");var ArtistCollectionView=CollectionView.extend({template:"artist_collection",itemViewClass:ArtistModelItemView});module.exports=ArtistCollectionView},{"../model_item/artist.js":36,"./view.js":20}],18:[function(_dereq_,module,exports){var CollectionView=_dereq_("./view.js");var TrackModelItemView=_dereq_("../model_item/track.js");var TrackCollectionView=CollectionView.extend({template:"track_collection",itemViewClass:TrackModelItemView});module.exports=TrackCollectionView},{"../model_item/track.js":37,"./view.js":20}],19:[function(_dereq_,module,exports){var CollectionView=_dereq_("./view.js");var TracklistTrackView=_dereq_("../model_item/tracklist_track.js");var TracklistCollectionView=CollectionView.extend({template:"tracklist_collection",itemViewClass:TracklistTrackView});module.exports=TracklistCollectionView},{"../model_item/tracklist_track.js":38,"./view.js":20}],20:[function(_dereq_,module,exports){var View=_dereq_("../view.js");var ModelView=_dereq_("../model/view.js");var CollectionView=View.extend({tagName:"ul",className:"interactive-list loading",attributes:{role:"listbox"},itemViewClass:ModelView,initialize:function(options){View.prototype.initialize.call(this,options);this._checkable=!!options.checkable;this.views=[];this.collection=options.collection;this.listenTo(this.collection,"add",this._addModelView);this.listenTo(this.collection,"change",this.render);this.listenTo(this.collection,"reset",this.render);this.listenTo(this.collection,"sort",this.render);this.listenTo(this.collection,"sort",this._hideLoadingMessage);this.listenTo(this.collection,"change",this._hideLoadingMessage);this.listenTo(this.collection,"reset",this._hideLoadingMessage)},render:function(){this.trigger("rendering");var data={collection:this.collection.toJSON()};if(!this.collection.length){this.$el.html(this._template(data));this._initialRender=true}else{if(!this._initialRender){this.$el.html(this._template(data));this._initialRender=true}this._renderViews();this.$(".empty-list").remove()}this.trigger("rendered");return this},remove:function(){View.prototype.remove.apply(this);this.collection.stopListening()},next:function(view){var index=this._viewIndex(view);if(index!==undefined&&index<this.views.length-1){this.updateSelected(this.views[index+1])}},prev:function(view){var index=this._viewIndex(view);if(index!==undefined&&index>0){this.updateSelected(this.views[index-1])}},updateSelected:function(view){var length=this.views.length;var i;for(i=0;i<length;i++){this.views[i].setSelected(view.model.cid===this.views[i].model.cid)}},removeSubView:function(view){var index=this.views.indexOf(view);if(index!==-1){this.views.splice(index,1)}},_viewIndex:function(view){return this.views.reduce(function(previous,current,index){if(previous!==undefined){return previous}return view.model.cid===current.model.cid?index:undefined},undefined)},_hideLoadingMessage:function(){this.$el.removeClass("loading")},_removeViews:function(){var i=this.views.length;while(i--){this.views.pop().remove()}},_renderViews:function(){var i;var collection=this.collection;if(this.views.length){this.views.sort(function(a,b){var ai=collection.indexOf(a.model);var bi=collection.indexOf(b.model);return ai-bi});for(i=0;i<this.views.length;i++){this.el.appendChild(this.views[i].el);if(i===0){this.views[i].el.setAttribute("tabindex",0)}}}else{this.$(".empty-list").remove()}},_addModelView:function(model,index){var view=new this.itemViewClass({mopidy:this.mopidy,router:this.router,model:model,collectionView:this,lastfm:this._lastfm,checkable:this._checkable});this.views.push(view);this.$el.append(view.render().el)},getChecked:function(){return this.views.filter(function(view){return view.isChecked()})},allChecked:function(){return this.getChecked().length===this.collection.length},checkAll:function(checked){this.views.forEach(function(view){view.setChecked(checked)})},_hideOnRender:false,_updateListItems:function($current){this.$(".interactive-list-item").each(function(i){var $item=$(this);if($item.is($current)){$item.attr("tabindex",0);$item.attr("aria-selected","true")}else{$item.attr("tabindex",-1);$item.attr("aria-selected","false")}})}});module.exports=CollectionView},{"../model/view.js":34,"../view.js":47}],21:[function(_dereq_,module,exports){var ListView=_dereq_("./view.js");var TrackCollectionView=_dereq_("../collection/track.js");var TrackListView=ListView.extend({_collectionViewClass:TrackCollectionView,template:"track_list",events:{"click .queue_all":"_queueAll","click .queue_selected":"_queueSelected","change .action-toolbar input[type=checkbox]":"_toggleChecked"},_queueSelected:function(){var selectedModelViews=this._collectionView.getChecked();var tracks;if(selectedModelViews.length){tracks=selectedModelViews.map(function(view){return view.model.toJSON()});this.mopidy.tracklist.add(tracks).then(function(){selectedModelViews.forEach(function(view){view.setChecked(false)})})}},_toggleChecked:function(event){this._collectionView.checkAll(!this._collectionView.allChecked())}});module.exports=TrackListView},{"../collection/track.js":18,"./view.js":23}],22:[function(_dereq_,module,exports){var ListView=_dereq_("./view.js");var TrackListCollectionView=_dereq_("../collection/track_list.js");var TrackListListView=ListView.extend({_collectionViewClass:TrackListCollectionView,initialize:function(options){ListView.prototype.initialize.call(this,options);this.on("rendered",this._fetchTrackList.bind(this))},template:"tracklist_list",events:{"click .clear_queue":"_clearQueue","click .delete_selected":"_deleteChecked"},_clearQueue:function(){var message1="If you click OK to this, you WILL wipe the queue. Are you sure?",message2="Really Sure? With great power, comes great responsibility.";if(confirm(message1)&&confirm(message2)){this.mopidy.tracklist.clear()}},_deleteChecked:function(event){this._deleteCheckedTracks(this._collectionView.getChecked().map(function(view){return view.model.get("tlid")}))},_deleteCheckedTracks:function(tlids){this.mopidy.tracklist.remove({tlid:tlids})},_fetchTrackList:function(){this._collection.fetch()}});module.exports=TrackListListView},{"../collection/track_list.js":19,"./view.js":23}],23:[function(_dereq_,module,exports){var View=_dereq_("../view.js");var ListView=View.extend({tagName:"div",className:"view-list",_collectionViewClass:null,initialize:function(options){View.prototype.initialize.call(this,options);options=options||{};this._collection=options.collection;this._initSubView()},render:function(){this.trigger("rendering");this.$el.html(this._template());this.el.appendChild(this._collectionView.render().el);this.trigger("rendered");return this},_initSubView:function(){this._collectionView=new this._collectionViewClass({mopidy:this.mopidy,router:this.router,collection:this._collection,lastfm:this._lastfm})}});module.exports=ListView},{"../view.js":47}],24:[function(_dereq_,module,exports){var $=_dereq_("jquery");var View=_dereq_("../view.js");var JoinView=View.extend({tagName:"div",initialize:function(options){View.prototype.initialize.call(this,options);this.views=options.views||[]},render:function(){var i;var wrap;this.trigger("rendering");for(i=0;i<this.views.length;i++){if(this.views[i].wrap){wrap=$(this.views[i].wrap).appendTo(this.el);this.views[i].view.render().$el.appendTo(wrap)}else{this.el.appendChild(this.views[i].view.render().el)}}this.trigger("rendered");return this}});module.exports=JoinView},{"../view.js":47,jquery:"HlZQrA"}],25:[function(_dereq_,module,exports){var $=_dereq_("jquery");var View=_dereq_("../view.js");var PlaybackControlView=_dereq_("./playback_controls.js");var VolumeControlView=_dereq_("./volume_control.js");var MainControlView=View.extend({tagName:"div",className:"row",initialize:function(options){View.prototype.initialize.call(this,options);this._initSubViews()},render:function(){var i;var col;this.trigger("rendering");for(i=0;i<this.views.length;i++){col=$('<div class="col-xs-6"></div>').appendTo(this.el);this.views[i].view.render().$el.appendTo(col)}this.trigger("rendered");return this},_initSubViews:function(){this.views=[{name:"Playback",view:new PlaybackControlView({router:this.router,mopidy:this.mopidy,config:this._config,lastfm:this._lastfm})},{name:"Volume",view:new VolumeControlView({router:this.router,mopidy:this.mopidy,config:this._config,lastfm:this._lastfm})}]}});module.exports=MainControlView},{"../view.js":47,"./playback_controls.js":27,"./volume_control.js":29,jquery:"HlZQrA"}],26:[function(_dereq_,module,exports){var View=_dereq_("../view");var Track=_dereq_("../../model/track.js");var _=_dereq_("backbone/node_modules/underscore");var NowPlayingView=View.extend({tagName:"div",className:"view-model",template:"nowplaying_view",initialize:function(options){View.prototype.initialize.call(this,options);this.listenTo(this.mopidy,"event:trackPlaybackStarted",this._updateTrack);this.mopidy.playback.getCurrentTlTrack().then(function(data){if(!data){return}this._updateTrack({tl_track:data})}.bind(this))},remove:function(){View.prototype.remove.apply(this,arguments)},render:function(){var data=this._track&&this._track.toJSON?this._track.toJSON():{};this.trigger("rendering");this.$el.html(this._template(data));this.trigger("rendered");return this},_updateTrack:function(data){if(data){this._track=new Track(data.tl_track.track,{mopidy:this.mopidy,lastfm:this._lastfm});this._track.once("sync",this.render.bind(this));this._track.fetch()}}});module.exports=NowPlayingView},{"../../model/track.js":12,"../view":47,"backbone/node_modules/underscore":48}],27:[function(_dereq_,module,exports){var View=_dereq_("../view.js");var PlaybackControlView=View.extend({tagName:"nav",className:"playback-controls",template:"home_playback_control",events:{"click .playback-controls-back":"previous","click .playback-controls-next":"next","click .playback-controls-play":"play","click .playback-controls-pause":"pause"},initialize:function(options){View.prototype.initialize.call(this,options);this.on("rendered",function(){this.mopidy.playback.getState().then(this._changePlaybackState.bind(this))}.bind(this));this.listenTo(this.mopidy,"event:playbackStateChanged",this._onPlaybackStateChanged.bind(this))},play:function(){this.mopidy.playback.play()},pause:function(){this.mopidy.playback.pause()},next:function(){this.mopidy.playback.next()},previous:function(){this.mopidy.playback.previous()},_onPlaybackStateChanged:function(event){this._changePlaybackState(event.new_state)},_changePlaybackState:function(state){if(state==="playing"){this.$el.addClass("playing")}else{this.$el.removeClass("playing")}}});module.exports=PlaybackControlView},{"../view.js":47}],28:[function(_dereq_,module,exports){var View=_dereq_("../view.js");var SearchControlView=View.extend({tagName:"nav",className:"search-controls",template:"home_search_control",events:{"keyup [type=search]":"search"},search:function(event){var query=encodeURIComponent(event.currentTarget.value);if(event.which===13&&query!==""){this.router.navigate("search/"+query,{trigger:true})}}});module.exports=SearchControlView},{"../view.js":47}],29:[function(_dereq_,module,exports){var View=_dereq_("../view.js");var VolumeControlView=View.extend({tagName:"nav",className:"volume-controls",template:"home_volume_control",events:{"click .volume-down":"_decrementVolume","click .volume-up":"_incrementVolume"},initialize:function(options){View.prototype.initialize.call(this,options);this.listenTo(this.mopidy,"event:volumeChanged",this._onVolumeChanged.bind(this));this.once("rendered",this._initializeVolume.bind(this))},render:function(){this.$el.html(this._template({volume:this._volumeLevel}));this.trigger("rendered");return this},remove:function(){View.prototype.remove.apply(this,arguments)},_volumeChangeTimeout:null,_volumeChangeTimeoutDelay:1e3,_volumeLevel:null,_onVolumeControlChange:function(event){event.srcElement.value=event.srcElement.value.replace(/[^0-9]+/,"");this._volumeLevel=event.srcElement.value;window.clearTimeout(this._volumeChangeTimeout);this._volumeChangeTimeout=window.setTimeout(this._updateVolume.bind(this,+this._volumeLevel),this._volumeChangeTimeoutDelay)},_onVolumeChanged:function(event){this._volumeLevel=event.volume;this._updateVolumeControl()},_updateVolume:function(volume){this.mopidy.playback.setVolume(volume)},_updateVolumeControl:function(){this.$(".volume-level").text(this._volumeLevel)},_decrementVolume:function(){this._volumeLevel--;this._updateVolume(this._volumeLevel)},_incrementVolume:function(){this._volumeLevel++;this._updateVolume(this._volumeLevel)},_initializeVolume:function(){this.mopidy.playback.getVolume().then(this._onGetVolume.bind(this))},_onGetVolume:function(volume){this._volumeLevel=volume;this.render()}});module.exports=VolumeControlView},{"../view.js":47}],30:[function(_dereq_,module,exports){var View=_dereq_("../view.js");var AlertView=View.extend({className:"modal in",initialize:function(options){View.prototype.initialize.call(this,options);options=options||{};this._data={header:options.header,message:options.message}},render:function(){this._overlayElement=this._createOverlay();document.body.appendChild(this._overlayElement);this.el.innerHTML=this._template(this._data);this.el.style.display="block";return this},remove:function(){this.$el.fadeOut("fast",View.prototype.remove.bind(this));this._overlayElement.parentElement.removeChild(this._overlayElement)},_template:_dereq_("../../../templates/modal/alert.hbs"),_createOverlay:function(){var overlay=document.createElement("div");overlay.className="modal-backdrop in";return overlay}});module.exports=AlertView},{"../../../templates/modal/alert.hbs":100,"../view.js":47}],31:[function(_dereq_,module,exports){var ModelView=_dereq_("./view.js");var AlbumView=ModelView.extend({tagName:"article",template:"album_model"});module.exports=AlbumView},{"./view.js":34}],32:[function(_dereq_,module,exports){var ModelView=_dereq_("./view.js");var ArtistView=ModelView.extend({tagName:"article",template:"artist_model"});module.exports=ArtistView},{"./view.js":34}],33:[function(_dereq_,module,exports){var ModelView=_dereq_("./view.js");var ArtistLinkView=ModelView.extend({tagName:"div",className:function(){return ModelView.prototype.className+" view-model-link"
},template:"artist_link_model",events:{"click a":"_viewArtist"},_viewArtist:function(event){event.preventDefault();this.router.navigate("/artists/"+this.model.id+"/"+encodeURIComponent(this.model.get("name")),{trigger:true})}});module.exports=ArtistLinkView},{"./view.js":34}],34:[function(_dereq_,module,exports){var View=_dereq_("../view.js");var ModelView=View.extend({className:"view-model",initialize:function(options){View.prototype.initialize.call(this,options);if(options.extended){this._extended=!!options.extended}this.model=options.model;this.listenTo(this.model,"change",this.render);this.listenTo(this.model,"remove",this.remove)},render:function(){var model=this.model.toJSON();this.trigger("rendering");this.$el.html(this._template(model));this.trigger("rendered");return this},remove:function(){View.prototype.remove.apply(this)},_hideOnRender:false});module.exports=ModelView},{"../view.js":47}],35:[function(_dereq_,module,exports){var ModelView=_dereq_("./view.js");var AlbumItemView=ModelView.extend({tagName:"li",template:"album_item_model",className:"interactive-list-item",_viewAlbum:function(){this.router.navigate("/albums/"+this.model.id+"/"+encodeURIComponent(this.model.get("artists")[0].name)+"/"+encodeURIComponent(this.model.get("name")),{trigger:true})},_onClick:function(event){this._viewAlbum()}});module.exports=AlbumItemView},{"./view.js":39}],36:[function(_dereq_,module,exports){var extend=_dereq_("backbone/node_modules/underscore").extend;var ModelItemView=_dereq_("./view.js");var ArtistModelItemView=ModelItemView.extend({tagName:"li",template:"artist_item_model",className:"interactive-list-item",_onClick:function(event){ModelItemView.prototype._onClick.call(this,event);this._viewArtist()},_onKeyDown:function(event){var enter=13;if(event.which===13){this._viewArtist()}else{ModelItemView.prototype._onKeyDown.call(this,event)}},_viewArtist:function(){this.router.navigate("/artists/"+this.model.id+"/"+encodeURIComponent(this.model.get("name")),{trigger:true})}});module.exports=ArtistModelItemView},{"./view.js":39,"backbone/node_modules/underscore":48}],37:[function(_dereq_,module,exports){var extend=_dereq_("backbone/node_modules/underscore").extend;var ModelItemView=_dereq_("./view.js");var TrackView=ModelItemView.extend({tagName:"li",events:function(){return extend({},ModelItemView.prototype.events,{"dblclick li":"_addToTracklist"})},template:"track_model_item",className:"interactive-list-item",initialize:function(options){ModelItemView.prototype.initialize.call(this,options)},_checkable:true,_addToTracklist:function(event){this.model.save()}});module.exports=TrackView},{"./view.js":39,"backbone/node_modules/underscore":48}],38:[function(_dereq_,module,exports){var extend=_dereq_("backbone/node_modules/underscore").extend;var ModelItemView=_dereq_("./view.js");var TracklistTrackModelItemView=ModelItemView.extend({tagName:"li",className:"interactive-list-item",template:"tracklist_model",events:function(){return extend({},ModelItemView.prototype.events,{dblclick:"play",dragstart:"_onDragStart",dragend:"_onDragEnd",drop:"_onDrop",dragenter:"_onDragEnter",dragover:"_onDragOver",dragleave:"_onDragLeave"})},initialize:function(options){ModelItemView.prototype.initialize.call(this,options);this.on("rendered",this._onRendered.bind(this))},play:function(event){var isKeyDownPlay=event.type==="keydown"&&event.which===13;var isDoubleClick=event.type==="dblclick";if(isKeyDownPlay||isDoubleClick){event.preventDefault();this.mopidy.playback.play(this.model.attributes)}},_checkable:true,_onKeydown:function(event){var enterKey=event.which===13;var spaceKey=event.which===32;if(enterKey){this._play(event)}else if(spaceKey){this._toggleSelected(event)}},_onRendered:function(){this._enableDraggableOnElement();this._toggleCurrentTrackIfCurrent()},_enableDraggableOnElement:function(){this.$el.attr("draggable","true")},_toggleCurrentTrackIfCurrent:function(){if(this.model.current){this.$el.addClass("current_track")}else{this.$el.removeClass("current_track")}},_toggleSelected:function(event){var checkbox=this.$("input[type=checkbox]")[0];checkbox.checked=!checkbox.checked;event.preventDefault()},_onDragStart:function(event){event.originalEvent.dataTransfer.setData("track_index",this.model.collection.indexOf(this.model))},_onDragEnd:function(event){this.$el.removeClass("dragover")},_onDrop:function(event){var index,sourceTrack,targetIndex,newIndex;if(this.model&&this.model.collection){index=+event.originalEvent.dataTransfer.getData("track_index");sourceTrack=this.model.collection.at(index);targetIndex=this.model.collection.indexOf(this.model);newIndex=targetIndex+(targetIndex<index?1:0);this.$el.removeClass("dragover");if(index!==targetIndex){this.model.collection.move(sourceTrack,newIndex)}}},_onDragEnter:function(event){this.$el.addClass("dragover");event.preventDefault()},_onDragOver:function(event){event.preventDefault()},_onDragLeave:function(event){this.$el.removeClass("dragover")}});module.exports=TracklistTrackModelItemView},{"./view.js":39,"backbone/node_modules/underscore":48}],39:[function(_dereq_,module,exports){var ModelView=_dereq_("../model/view.js");var ModelItemView=ModelView.extend({initialize:function(options){ModelView.prototype.initialize.call(this,options);this._collectionView=options.collectionView;this._selected=false;this._checked=false},attributes:function(){var attrs={role:"option","aria-selected":"false",tabindex:"-1"};if(this._checkable){attrs["aria-checked"]="false"}return attrs},remove:function(){this._collectionView.removeSubView(this);return ModelView.prototype.remove.call(this)},events:{keydown:"_onKeyDown",click:"_onClick","click input[type=checkbox]":"_onClickCheckbox",focus:"_onFocus"},isSelected:function(){return this._selected},isChecked:function(){return this._checked},setSelected:function(selected){var alreadySelected=this.isSelected();if(selected){this._selected=true;this.el.setAttribute("aria-selected","true");this.el.setAttribute("tabindex",0);if(!alreadySelected){this.$el.focus()}}else{this._selected=false;this.el.setAttribute("aria-selected","false");this.el.setAttribute("tabindex",-1)}},setChecked:function(checked){if(checked){this._checked=true;this.el.setAttribute("aria-checked","true");this.$("input[type=checkbox]").prop("checked",true)}else{this._checked=false;this.el.setAttribute("aria-checked","false");this.$("input[type=checkbox]").prop("checked",false)}},toggleChecked:function(){this.setChecked(!this.isChecked())},_onKeyDown:function(event){var j=74,k=75,up=38,down=40,space=32;if(event.which===j||event.which===down){event.preventDefault();this._collectionView.next(this)}else if(event.which===k||event.which===up){event.preventDefault();this._collectionView.prev(this)}else if(this._checkable&&event.which===space){event.preventDefault();this.toggleChecked()}},_onClick:function(event){this._collectionView.updateSelected(this)},_onClickCheckbox:function(event){this.toggleChecked()},_onFocus:function(event){this._collectionView.updateSelected(this)}});module.exports=ModelItemView},{"../model/view.js":34}],40:[function(_dereq_,module,exports){var $=_dereq_("jquery");var View=_dereq_("../view.js");var PageView=_dereq_("./view.js");var JoinView=_dereq_("../misc/join.js");var SearchControlView=_dereq_("../misc/search_control.js");var MainControlView=_dereq_("../misc/main_control.js");var NavigationView=PageView.extend({initialize:function(options){View.prototype.initialize.call(this,options);this._initSubViews()},_template:_dereq_("../../../templates/navigation/index.hbs"),_initSubViews:function(){this.views=[{name:"Search",view:new SearchControlView({router:this.router,mopidy:this.mopidy,config:this._config,lastfm:this._lastfm})},{name:"Controls",view:new MainControlView({router:this.router,mopidy:this.mopidy,config:this._config,lastfm:this._lastfm})}]},render:function(){var i;var col;this.trigger("rendering");this.$el.html(this._template());col=$('<div class="view-section"></div>').appendTo(this.el);this.views[0].view.render().$el.appendTo(col);col=$('<div class="view-section"></div>').appendTo(this.el);this.views[1].view.render().$el.appendTo(col);this.trigger("rendered");return this}});module.exports=NavigationView},{"../../../templates/navigation/index.hbs":102,"../misc/join.js":24,"../misc/main_control.js":25,"../misc/search_control.js":28,"../view.js":47,"./view.js":42,jquery:"HlZQrA"}],41:[function(_dereq_,module,exports){var $=_dereq_("jquery");var View=_dereq_("../view.js");var PageView=_dereq_("./view.js");var JoinView=_dereq_("../misc/join.js");var SearchControlView=_dereq_("../misc/search_control.js");var MainControlView=_dereq_("../misc/main_control.js");var NowPlayingView=_dereq_("../misc/now_playing.js");var TrackListListView=_dereq_("../list/track_list.js");var TrackListCollection=_dereq_("../../collection/track_list.js");var RootView=PageView.extend({initialize:function(options){View.prototype.initialize.call(this,options);this._initSubViews()},_template:_dereq_("../../../templates/root/index.hbs"),_initSubViews:function(){this.views=[{name:"MainContent",view:new JoinView({router:this.router,mopidy:this.mopidy,config:this._config,lastfm:this._lastfm,views:[{name:"NowPlaying",view:new NowPlayingView({router:this.router,mopidy:this.mopidy,config:this._config,lastfm:this._lastfm})},{name:"Queue",view:new TrackListListView({router:this.router,collection:new TrackListCollection(null,{mopidy:this.mopidy}),mopidy:this.mopidy,config:this._config,lastfm:this._lastfm})}]})}]},render:function(){var i;var col;this.trigger("rendering");this.$el.html(this._template());col=$('<div class="view-section"></div>').appendTo(this.el);this.views[0].view.render().$el.appendTo(col);this.trigger("rendered");return this}});module.exports=RootView},{"../../../templates/root/index.hbs":104,"../../collection/track_list.js":6,"../list/track_list.js":22,"../misc/join.js":24,"../misc/main_control.js":25,"../misc/now_playing.js":26,"../misc/search_control.js":28,"../view.js":47,"./view.js":42,jquery:"HlZQrA"}],42:[function(_dereq_,module,exports){var View=_dereq_("../view.js");var PageView=View.extend({initialize:function(options){View.prototype.initialize.call(this,options);this._initSubViews();this.listenTo(this.router,"beforeRoute",this.remove)},render:function(){var i;this.trigger("rendering");this.$el.html(this._template());for(i=0;i<this.views.length;i++){this.el.appendChild(this.views[i].view.render().el)}this._setTitle(this.title);this.trigger("rendered");return this},remove:function(){this.stopListening();View.prototype.remove.apply(this,arguments)},_setTitle:function(title){$("title").text(title+": "+this._config.title)}});module.exports=PageView},{"../view.js":47}],43:[function(_dereq_,module,exports){var TabView=_dereq_("./view.js");var JoinView=_dereq_("../misc/join.js");var AlbumView=_dereq_("../model/album.js");var ArtistLinkView=_dereq_("../model/artist_link.js");var TrackListView=_dereq_("../list/track.js");var Album=_dereq_("../../model/album.js");var AlbumTabView=TabView.extend({tagName:"div",className:"view",title:"Albums",initialize:function(options){this.album=new Album({uri:options.id,title:options.name,artist:options.artist},{mopidy:options.mopidy,router:options.router,lastfm:options.lastfm});TabView.prototype.initialize.call(this,options);this.album.fetch()},queueAll:function(){this.mopidy.tracklist.add(this.album.tracks.toJSON()).then(function(){})},queueSelected:function(){var selectedInputs=this.$("li input[type=checkbox]:checked");var selectedTracks=selectedInputs.map(function(i,track){return this.album.tracks.get(track.getAttribute("data-track-id")).toJSON()}.bind(this));this.mopidy.tracklist.add(selectedTracks).then(function(){selectedInputs.each(function(i,input){input.checked=false})}.bind(this))},_initSubViews:function(){this.views=[{name:this.album.get("title"),view:new JoinView({mopidy:this.mopidy,router:this.router,lastfm:this._lastfm,views:[{view:new AlbumView({model:this.album,mopidy:this.mopidy,router:this.router,lastfm:this._lastfm})},{view:new ArtistLinkView({model:this.album.artist,mopidy:this.mopidy,router:this.router,lastfm:this._lastfm})},{view:new TrackListView({collection:this.album.tracks,mopidy:this.mopidy,router:this.router,lastfm:this._lastfm})}]})}]}});module.exports=AlbumTabView},{"../../model/album.js":8,"../list/track.js":21,"../misc/join.js":24,"../model/album.js":31,"../model/artist_link.js":33,"./view.js":46}],44:[function(_dereq_,module,exports){var PageView=_dereq_("./view.js");var AlbumCollectionView=_dereq_("../collection/album.js");var TrackListView=_dereq_("../list/track.js");var ArtistView=_dereq_("../model/artist.js");var JoinView=_dereq_("../misc/join.js");var Artist=_dereq_("../../model/artist.js");var ArtistTabView=PageView.extend({tagName:"div",title:"Artists",initialize:function(options){this.artist=new Artist({uri:options.uri,name:options.name},{mopidy:options.mopidy,router:options.router,lastfm:options.lastfm});PageView.prototype.initialize.call(this,options);this.artist.fetch()},_initSubViews:function(){this.views=[{name:this.artist.get("name"),view:new JoinView({views:[{name:this.artist.get("name"),view:new ArtistView({mopidy:this.mopidy,router:this.router,lastfm:this._lastfm,model:this.artist})},{name:"Albums",view:new AlbumCollectionView({mopidy:this.mopidy,router:this.router,lastfm:this._lastfm,collection:this.artist.albums})}]})},{name:"Tracks",view:new TrackListView({mopidy:this.mopidy,router:this.router,lastfm:this._lastfm,collection:this.artist.tracks,extended:true})}]}});module.exports=ArtistTabView},{"../../model/artist.js":9,"../collection/album.js":16,"../list/track.js":21,"../misc/join.js":24,"../model/artist.js":32,"./view.js":46}],45:[function(_dereq_,module,exports){var TabView=_dereq_("./view.js");var TrackListView=_dereq_("../list/track.js");var AlbumCollectionView=_dereq_("../collection/album.js");var ArtistCollectionView=_dereq_("../collection/artist.js");var SearchTabView=TabView.extend({tagName:"div",className:"view-section",title:"Search",initialize:function(options){this.model=options.model;TabView.prototype.initialize.call(this,options);this.model.fetch({query:options.query})},resetResults:function(){this.views.albums.resetResults();this.views.artists.resetResults();this.views.tracks.resetResults()},_initSubViews:function(){this.views=[{name:"Artists",view:new ArtistCollectionView({collection:this.model.artists,mopidy:this.mopidy,router:this.router,lastfm:this._lastfm})},{name:"Albums",view:new AlbumCollectionView({collection:this.model.albums,mopidy:this.mopidy,router:this.router,lastfm:this._lastfm})},{name:"Tracks",view:new TrackListView({collection:this.model.tracks,mopidy:this.mopidy,router:this.router,lastfm:this._lastfm})}]}});module.exports=SearchTabView},{"../collection/album.js":16,"../collection/artist.js":17,"../list/track.js":21,"./view.js":46}],46:[function(_dereq_,module,exports){var $=_dereq_("jquery");var PageView=_dereq_("../page/view.js");var TabView=PageView.extend({className:"tab-view-section",template:"tab_view",events:{"click [role=tab]":"_clickTab","keydown [role=tab]":"_switchTab"},initialize:function(options){PageView.prototype.initialize.call(this,options)},render:function(){var i;var baseName=Date.now();var panel;this.trigger("rendering");this.$el.html(this._template({baseName:baseName,tabs:this._getTabs()}));for(i=0;i<this.views.length;i++){panel=$(this._generateTabHTML(i,baseName)).appendTo(this.el);$(this.views[i].view.render().el).appendTo(panel)}this.trigger("rendered");return this},_getTabs:function(){return this.views.map(function(v,index){return v.name}.bind(this))},_generateTabHTML:function(index,baseName){var currentTabClass="";var ariaHiddenAttribute="true";if(index===0){ariaHiddenAttribute="false"}return'<div class="tab-view-section-tab opaque" id="panel-'+baseName+"-"+index+'" aria-labeledby="tab-'+baseName+"-"+index+'" role="tabpanel" aria-hidden="'+ariaHiddenAttribute+'"></div>'},_clickTab:function(event){var selected=event.target.getAttribute("aria-controls");this._updateTabs(selected)},_updateTabs:function(selected){this.$("[role=tab]").each(function(i){var $tab=$(this);var id=$tab.attr("aria-controls");if(id===selected){$tab.attr("tabindex",0)}else{$tab.attr("tabindex",-1)}});this.$("[role=tabpanel]").each(function(i){var $panel=$(this);var id=$panel.attr("id");if(id===selected){$panel.addClass("current-tab");$panel.attr("aria-hidden","false")}else{$panel.removeClass("current-tab");$panel.attr("aria-hidden","true")}})},_switchTab:function(event){var selected;var right=39,l=76,h=72,left=37;if(event.which===right||event.which===l){selected=$(event.target).next("[role=tab]").eq(0);if(selected.length){event.preventDefault();selected.focus();this._updateTabs(selected.attr("aria-controls"))}}else if(event.which===left||event.which===h){selected=$(event.target).prev("[role=tab]").eq(0);if(selected.length){event.preventDefault();selected.focus();this._updateTabs(selected.attr("aria-controls"))}}}});module.exports=TabView},{"../page/view.js":42,jquery:"HlZQrA"}],47:[function(_dereq_,module,exports){var templates=_dereq_("../templates.js");var Backbone=_dereq_("backbone");var View=Backbone.View.extend({initialize:function(options){Backbone.View.prototype.initialize.call(this,options);options=options||{};options.templates=options.templates||templates;if(this.template){this._setTemplate(templates)}if(options.mopidy){this.mopidy=options.mopidy}if(options.router){this.router=options.router}if(options.config){this._config=options.config}this._lastfm=options.lastfm;this.on("rendering",this._rendering,this);this.on("rendered",this._rendered,this)},remove:function(callback){this.$el.toggleClass("hidden");Backbone.View.prototype.remove.apply(this,arguments)},render:function(){this.trigger("rendering");this.$el.html(this._template());this.trigger("rendered");return this},_setTemplate:function(templates){this._template=templates[this.template]},_rendering:function(){if(this._hideOnRender){this.$el.addClass("hidden")}},_rendered:function(){if(this._hideOnRender){this.$el.removeClass("hidden")}},_hideOnRender:false});Backbone.$=_dereq_("jquery");module.exports=View},{"../templates.js":15,backbone:"5kFNoY",jquery:"HlZQrA"}],48:[function(_dereq_,module,exports){(function(){var root=this;var previousUnderscore=root._;var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=_}exports._=_}else{root._=_}_.VERSION="1.7.0";var createCallback=function(func,context,argCount){if(context===void 0)return func;switch(argCount==null?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};_.iteratee=function(value,context,argCount){if(value==null)return _.identity;if(_.isFunction(value))return createCallback(value,context,argCount);if(_.isObject(value))return _.matches(value);return _.property(value)};_.each=_.forEach=function(obj,iteratee,context){if(obj==null)return obj;iteratee=createCallback(iteratee,context);var i,length=obj.length;if(length===+length){for(i=0;i<length;i++){iteratee(obj[i],i,obj)}}else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++){iteratee(obj[keys[i]],keys[i],obj)}}return obj};_.map=_.collect=function(obj,iteratee,context){if(obj==null)return[];iteratee=_.iteratee(iteratee,context);var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,results=Array(length),currentKey;for(var index=0;index<length;index++){currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iteratee,memo,context){if(obj==null)obj=[];iteratee=createCallback(iteratee,context,4);var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index=0,currentKey;if(arguments.length<3){if(!length)throw new TypeError(reduceError);memo=obj[keys?keys[index++]:index++]}for(;index<length;index++){currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo};_.reduceRight=_.foldr=function(obj,iteratee,memo,context){if(obj==null)obj=[];iteratee=createCallback(iteratee,context,4);var keys=obj.length!==+obj.length&&_.keys(obj),index=(keys||obj).length,currentKey;if(arguments.length<3){if(!index)throw new TypeError(reduceError);memo=obj[keys?keys[--index]:--index]}while(index--){currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo};_.find=_.detect=function(obj,predicate,context){var result;predicate=_.iteratee(predicate,context);_.some(obj,function(value,index,list){if(predicate(value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,predicate,context){var results=[];if(obj==null)return results;predicate=_.iteratee(predicate,context);_.each(obj,function(value,index,list){if(predicate(value,index,list))results.push(value)});return results};_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(_.iteratee(predicate)),context)};_.every=_.all=function(obj,predicate,context){if(obj==null)return true;predicate=_.iteratee(predicate,context);var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index,currentKey;for(index=0;index<length;index++){currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return false}return true};_.some=_.any=function(obj,predicate,context){if(obj==null)return false;predicate=_.iteratee(predicate,context);var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index,currentKey;for(index=0;index<length;index++){currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return true}return false};_.contains=_.include=function(obj,target){if(obj==null)return false;if(obj.length!==+obj.length)obj=_.values(obj);return _.indexOf(obj,target)>=0};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,_.property(key))};_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))};_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))};_.max=function(obj,iteratee,context){var result=-Infinity,lastComputed=-Infinity,value,computed;if(iteratee==null&&obj!=null){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value>result){result=value}}}else{iteratee=_.iteratee(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed>lastComputed||computed===-Infinity&&result===-Infinity){result=value;lastComputed=computed}})}return result};_.min=function(obj,iteratee,context){var result=Infinity,lastComputed=Infinity,value,computed;if(iteratee==null&&obj!=null){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value<result){result=value}}}else{iteratee=_.iteratee(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed<lastComputed||computed===Infinity&&result===Infinity){result=value;lastComputed=computed}})}return result};_.shuffle=function(obj){var set=obj&&obj.length===+obj.length?obj:_.values(obj);var length=set.length;var shuffled=Array(length);for(var index=0,rand;index<length;index++){rand=_.random(0,index);if(rand!==index)shuffled[index]=shuffled[rand];shuffled[rand]=set[index]}return shuffled};_.sample=function(obj,n,guard){if(n==null||guard){if(obj.length!==+obj.length)obj=_.values(obj);return obj[_.random(obj.length-1)]}return _.shuffle(obj).slice(0,Math.max(0,n))};_.sortBy=function(obj,iteratee,context){iteratee=_.iteratee(iteratee,context);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};iteratee=_.iteratee(iteratee,context);_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)});return result}};_.groupBy=group(function(result,value,key){if(_.has(result,key))result[key].push(value);else result[key]=[value]});_.indexBy=group(function(result,value,key){result[key]=value});_.countBy=group(function(result,value,key){if(_.has(result,key))result[key]++;else result[key]=1});_.sortedIndex=function(array,obj,iteratee,context){iteratee=_.iteratee(iteratee,context,1);var value=iteratee(obj);var low=0,high=array.length;while(low<high){var mid=low+high>>>1;if(iteratee(array[mid])<value)low=mid+1;else high=mid}return low};_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(obj.length===+obj.length)return _.map(obj,_.identity);return _.values(obj)};_.size=function(obj){if(obj==null)return 0;return obj.length===+obj.length?obj.length:_.keys(obj).length};_.partition=function(obj,predicate,context){predicate=_.iteratee(predicate,context);var pass=[],fail=[];_.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)});return[pass,fail]};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[0];if(n<0)return[];return slice.call(array,0,n)};_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(n==null||guard?1:n)))};_.last=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[array.length-1];return slice.call(array,Math.max(array.length-n,0))};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,output){if(shallow&&_.every(input,_.isArray)){return concat.apply(output,input)}for(var i=0,length=input.length;i<length;i++){var value=input[i];if(!_.isArray(value)&&!_.isArguments(value)){if(!strict)output.push(value)}else if(shallow){push.apply(output,value)}else{flatten(value,shallow,strict,output)}}return output};_.flatten=function(array,shallow){return flatten(array,shallow,false,[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iteratee,context){if(array==null)return[];if(!_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=false}if(iteratee!=null)iteratee=_.iteratee(iteratee,context);var result=[];var seen=[];for(var i=0,length=array.length;i<length;i++){var value=array[i];if(isSorted){if(!i||seen!==value)result.push(value);seen=value}else if(iteratee){var computed=iteratee(value,i,array);if(_.indexOf(seen,computed)<0){seen.push(computed);result.push(value)}}else if(_.indexOf(result,value)<0){result.push(value)}}return result};_.union=function(){return _.uniq(flatten(arguments,true,true,[]))};_.intersection=function(array){if(array==null)return[];var result=[];var argsLength=arguments.length;for(var i=0,length=array.length;i<length;i++){var item=array[i];if(_.contains(result,item))continue;for(var j=1;j<argsLength;j++){if(!_.contains(arguments[j],item))break}if(j===argsLength)result.push(item)}return result};_.difference=function(array){var rest=flatten(slice.call(arguments,1),true,true,[]);return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(array){if(array==null)return[];var length=_.max(arguments,"length").length;var results=Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(arguments,i)}return results};_.object=function(list,values){if(list==null)return{};var result={};for(var i=0,length=list.length;i<length;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i=0,length=array.length;if(isSorted){if(typeof isSorted=="number"){i=isSorted<0?Math.max(0,length+isSorted):isSorted}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1}}for(;i<length;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,item,from){if(array==null)return-1;var idx=array.length;if(typeof from=="number"){idx=from<0?idx+from+1:Math.min(idx,from+1)}while(--idx>=0)if(array[idx]===item)return idx;return-1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=step||1;var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step){range[idx]=start}return range};var Ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");args=slice.call(arguments,2);bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));Ctor.prototype=func.prototype;var self=new Ctor;Ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));if(_.isObject(result))return result;return self};return bound};_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){var position=0;var args=boundArgs.slice();for(var i=0,length=args.length;i<length;i++){if(args[i]===_)args[i]=arguments[position++]}while(position<arguments.length)args.push(arguments[position++]);return func.apply(this,args)}};_.bindAll=function(obj){var i,length=arguments.length,key;if(length<=1)throw new Error("bindAll must be passed function names");for(i=1;i<length;i++){key=arguments[i];obj[key]=_.bind(obj[key],obj)}return obj};_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache;var address=hasher?hasher.apply(this,arguments):key;if(!_.has(cache,address))cache[address]=func.apply(this,arguments);return cache[address]};memoize.cache={};return memoize};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;if(!options)options={};var later=function(){previous=options.leading===false?0:_.now();timeout=null;result=func.apply(context,args);if(!timeout)context=args=null};return function(){var now=_.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args);if(!timeout)context=args=null}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining)}return result}};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;var later=function(){var last=_.now()-timestamp;if(last<wait&&last>0){timeout=setTimeout(later,wait-last)}else{timeout=null;if(!immediate){result=func.apply(context,args);if(!timeout)context=args=null}}};return function(){context=this;args=arguments;timestamp=_.now();var callNow=immediate&&!timeout;if(!timeout)timeout=setTimeout(later,wait);
if(callNow){result=func.apply(context,args);context=args=null}return result}};_.wrap=function(func,wrapper){return _.partial(wrapper,func)};_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}};_.compose=function(){var args=arguments;var start=args.length-1;return function(){var i=start;var result=args[start].apply(this,arguments);while(i--)result=args[i].call(this,result);return result}};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments)}}};_.before=function(times,func){var memo;return function(){if(--times>0){memo=func.apply(this,arguments)}else{func=null}return memo}};_.once=_.partial(_.before,2);_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)if(_.has(obj,key))keys.push(key);return keys};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]]}return values};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]]}return pairs};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i]}return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=function(obj){if(!_.isObject(obj))return obj;var source,prop;for(var i=1,length=arguments.length;i<length;i++){source=arguments[i];for(prop in source){if(hasOwnProperty.call(source,prop)){obj[prop]=source[prop]}}}return obj};_.pick=function(obj,iteratee,context){var result={},key;if(obj==null)return result;if(_.isFunction(iteratee)){iteratee=createCallback(iteratee,context);for(key in obj){var value=obj[key];if(iteratee(value,key,obj))result[key]=value}}else{var keys=concat.apply([],slice.call(arguments,1));obj=new Object(obj);for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(key in obj)result[key]=obj[key]}}return result};_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee)){iteratee=_.negate(iteratee)}else{var keys=_.map(concat.apply([],slice.call(arguments,1)),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)};_.defaults=function(obj){if(!_.isObject(obj))return obj;for(var i=1,length=arguments.length;i<length;i++){var source=arguments[i];for(var prop in source){if(obj[prop]===void 0)obj[prop]=source[prop]}}return obj};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a===1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!==toString.call(b))return false;switch(className){case"[object RegExp]":case"[object String]":return""+a===""+b;case"[object Number]":if(+a!==+a)return+b!==+b;return+a===0?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}if(typeof a!="object"||typeof b!="object")return false;var length=aStack.length;while(length--){if(aStack[length]===a)return bStack[length]===b}var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&"constructor"in a&&"constructor"in b&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)){return false}aStack.push(a);bStack.push(b);var size,result;if(className==="[object Array]"){size=a.length;result=size===b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack)))break}}}else{var keys=_.keys(a),key;size=keys.length;result=_.keys(b).length===size;if(result){while(size--){key=keys[size];if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))break}}}aStack.pop();bStack.pop();return result};_.isEqual=function(a,b){return eq(a,b,[],[])};_.isEmpty=function(obj){if(obj==null)return true;if(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return false;return true};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]"};_.isObject=function(obj){var type=typeof obj;return type==="function"||type==="object"&&!!obj};_.each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return _.has(obj,"callee")}}if(typeof/./!=="function"){_.isFunction=function(obj){return typeof obj=="function"||false}}_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==="[object Boolean]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return obj!=null&&hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.constant=function(value){return function(){return value}};_.noop=function(){};_.property=function(key){return function(obj){return obj[key]}};_.matches=function(attrs){var pairs=_.pairs(attrs),length=pairs.length;return function(obj){if(obj==null)return!length;obj=new Object(obj);for(var i=0;i<length;i++){var pair=pairs[i],key=pair[0];if(pair[1]!==obj[key]||!(key in obj))return false}return true}};_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=createCallback(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var unescapeMap=_.invert(escapeMap);var createEscaper=function(map){var escaper=function(match){return map[match]};var source="(?:"+_.keys(map).join("|")+")";var testRegexp=RegExp(source);var replaceRegexp=RegExp(source,"g");return function(string){string=string==null?"":""+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap);_.unescape=createEscaper(unescapeMap);_.result=function(object,property){if(object==null)return void 0;var value=object[property];return _.isFunction(value)?object[property]():value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\u2028|\u2029/g;var escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){if(!settings&&oldSettings)settings=oldSettings;settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,escapeChar);index=offset+match.length;if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"}else if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"}else if(evaluate){source+="';\n"+evaluate+"\n__p+='"}return match});source+="';\n";if(!settings.variable)source="with(obj||{}){\n"+source+"}\n";source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e}var template=function(data){return render.call(this,data,_)};var argument=settings.variable||"obj";template.source="function("+argument+"){\n"+source+"}";return template};_.chain=function(obj){var instance=_(obj);instance._chain=true;return instance};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args))}})};_.mixin(_);_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==="shift"||name==="splice")&&obj.length===0)delete obj[0];return result.call(this,obj)}});_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}});_.prototype.value=function(){return this._wrapped};if(typeof define==="function"&&define.amd){define("underscore",[],function(){return _})}}).call(this)},{}],49:[function(_dereq_,module,exports){Storage.prototype.setObject=function(key,value){this.setItem(key,JSON.stringify(value))};Storage.prototype.getObject=function(key){var item=this.getItem(key);return JSON.parse(item)};function LastFMCache(){var MINUTE=60;var HOUR=MINUTE*60;var DAY=HOUR*24;var WEEK=DAY*7;var MONTH=WEEK*4.34812141;var YEAR=MONTH*12;var weeklyMethods=["artist.getSimilar","tag.getSimilar","track.getSimilar","artist.getTopAlbums","artist.getTopTracks","geo.getTopArtists","geo.getTopTracks","tag.getTopAlbums","tag.getTopArtists","tag.getTopTags","tag.getTopTracks","user.getTopAlbums","user.getTopArtists","user.getTopTags","user.getTopTracks"];var name="lastfm";if(localStorage.getObject(name)==null){localStorage.setObject(name,{})}this.getExpirationTime=function(params){var method=params.method;if(/Weekly/.test(method)&&!/List/.test(method)){if(typeof params.to!="undefined"&&typeof params.from!="undefined"){return YEAR}else{return WEEK}}for(var key in this.weeklyMethods){if(method==this.weeklyMethods[key]){return WEEK}}return-1};this.contains=function(hash){return typeof localStorage.getObject(name)[hash]!="undefined"&&typeof localStorage.getObject(name)[hash].data!="undefined"};this.load=function(hash){return localStorage.getObject(name)[hash].data};this.remove=function(hash){var object=localStorage.getObject(name);object[hash]=undefined;localStorage.setObject(name,object)};this.store=function(hash,data,expiration){var object=localStorage.getObject(name);var time=Math.round((new Date).getTime()/1e3);object[hash]={data:data,expiration:time+expiration};localStorage.setObject(name,object)};this.isExpired=function(hash){var object=localStorage.getObject(name);var time=Math.round((new Date).getTime()/1e3);if(time>object[hash].expiration){return true}return false};this.clear=function(){localStorage.setObject(name,{})}}module.exports=LastFMCache},{}],50:[function(_dereq_,module,exports){var crypto=_dereq_("crypto");var Cache=_dereq_("./cache.js");function md5(data){return crypto.createHash("md5").update(data).digest("hex")}function LastFM(options){var apiKey=options.apiKey||"";var apiSecret=options.apiSecret||"";var apiUrl=options.apiUrl||"http://ws.audioscrobbler.com/2.0/";var cache=options.cache||undefined;this.setApiKey=function(_apiKey){apiKey=_apiKey};this.setApiSecret=function(_apiSecret){apiSecret=_apiSecret};this.setApiUrl=function(_apiUrl){apiUrl=_apiUrl};this.setCache=function(_cache){cache=_cache};var jsonpCounter=0;var internalCall=function(params,callbacks,requestMethod){if(requestMethod==="POST"){var html=document.getElementsByTagName("html")[0];var iframe=document.createElement("iframe");var doc;iframe.width=1;iframe.height=1;iframe.style.border="none";iframe.onload=function(){if(typeof callbacks.success!=="undefined"){callbacks.success()}};html.appendChild(iframe);if(typeof iframe.contentWindow!=="undefined"){doc=iframe.contentWindow.document}else if(typeof iframe.contentDocument.document!=="undefined"){doc=iframe.contentDocument.document.document}else{doc=iframe.contentDocument.document}doc.open();doc.clear();doc.write('<form method="post" action="'+apiUrl+'" id="form">');var param;for(param in params){if(params.hasOwnProperty(param)){doc.write('<input type="text" name="'+param+'" value="'+params[param]+'">')}}doc.write("</form>");doc.write('<script type="application/x-javascript">');doc.write('document.getElementById("form").submit();');doc.write("</script>");doc.close()}else{var jsonp="jsonp"+(new Date).getTime()+jsonpCounter;jsonpCounter+=1;var hash=auth.getApiSignature(params);if(typeof cache!=="undefined"&&cache.contains(hash)&&!cache.isExpired(hash)){if(typeof callbacks.success!=="undefined"){callbacks.success(cache.load(hash))}return}params.callback=jsonp;params.format="json";window[jsonp]=function(data){if(typeof cache!=="undefined"){var expiration=cache.getExpirationTime(params);if(expiration>0){cache.store(hash,data,expiration)}}if(typeof data.error!=="undefined"){if(typeof callbacks.error!=="undefined"){callbacks.error(data.error,data.message)}}else if(typeof callbacks.success!=="undefined"){callbacks.success(data)}window[jsonp]=undefined;try{delete window[jsonp]}catch(e){}if(head){head.removeChild(script)}};var head=document.getElementsByTagName("head")[0];var script=document.createElement("script");var array=[];var param2;for(param2 in params){if(params.hasOwnProperty(param2)){array.push(encodeURIComponent(param2)+"="+encodeURIComponent(params[param2]))}}script.src=apiUrl+"?"+array.join("&").replace(/%20/g,"+");head.appendChild(script)}};var call=function(method,params,callbacks,requestMethod){params=params||{};callbacks=callbacks||{};requestMethod=requestMethod||"GET";params.method=method;params.api_key=apiKey;internalCall(params,callbacks,requestMethod)};var signedCall=function(method,params,session,callbacks,requestMethod){params=params||{};callbacks=callbacks||{};requestMethod=requestMethod||"GET";params.method=method;params.api_key=apiKey;if(session&&typeof session.key!=="undefined"){params.sk=session.key}params.api_sig=auth.getApiSignature(params);internalCall(params,callbacks,requestMethod)};this.album={addTags:function(params,session,callbacks){if(typeof params.tags==="object"){params.tags=params.tags.join(",")}signedCall("album.addTags",params,session,callbacks,"POST")},getBuylinks:function(params,callbacks){call("album.getBuylinks",params,callbacks)},getInfo:function(params,callbacks){call("album.getInfo",params,callbacks)},getTags:function(params,session,callbacks){signedCall("album.getTags",params,session,callbacks)},removeTag:function(params,session,callbacks){signedCall("album.removeTag",params,session,callbacks,"POST")},search:function(params,callbacks){call("album.search",params,callbacks)},share:function(params,session,callbacks){if(typeof params.recipient==="object"){params.recipient=params.recipient.join(",")}signedCall("album.share",params,callbacks)}};this.artist={addTags:function(params,session,callbacks){if(typeof params.tags==="object"){params.tags=params.tags.join(",")}signedCall("artist.addTags",params,session,callbacks,"POST")},getCorrection:function(params,callbacks){call("artist.getCorrection",params,callbacks)},getEvents:function(params,callbacks){call("artist.getEvents",params,callbacks)},getImages:function(params,callbacks){call("artist.getImages",params,callbacks)},getInfo:function(params,callbacks){call("artist.getInfo",params,callbacks)},getPastEvents:function(params,callbacks){call("artist.getPastEvents",params,callbacks)},getPodcast:function(params,callbacks){call("artist.getPodcast",params,callbacks)},getShouts:function(params,callbacks){call("artist.getShouts",params,callbacks)},getSimilar:function(params,callbacks){call("artist.getSimilar",params,callbacks)},getTags:function(params,session,callbacks){signedCall("artist.getTags",params,session,callbacks)},getTopAlbums:function(params,callbacks){call("artist.getTopAlbums",params,callbacks)},getTopFans:function(params,callbacks){call("artist.getTopFans",params,callbacks)},getTopTags:function(params,callbacks){call("artist.getTopTags",params,callbacks)},getTopTracks:function(params,callbacks){call("artist.getTopTracks",params,callbacks)},removeTag:function(params,session,callbacks){signedCall("artist.removeTag",params,session,callbacks,"POST")},search:function(params,callbacks){call("artist.search",params,callbacks)},share:function(params,session,callbacks){if(typeof params.recipient==="object"){params.recipient=params.recipient.join(",")}signedCall("artist.share",params,session,callbacks,"POST")},shout:function(params,session,callbacks){signedCall("artist.shout",params,session,callbacks,"POST")}};this.auth={getMobileSession:function(params,callbacks){params={username:params.username,authToken:md5(params.username+md5(params.password))};signedCall("auth.getMobileSession",params,null,callbacks)},getSession:function(params,callbacks){signedCall("auth.getSession",params,null,callbacks)},getToken:function(callbacks){signedCall("auth.getToken",null,null,callbacks)},getWebSession:function(callbacks){var previuousApiUrl=apiUrl;apiUrl="http://ext.last.fm/2.0/";signedCall("auth.getWebSession",null,null,callbacks);apiUrl=previuousApiUrl}};this.chart={getHypedArtists:function(params,session,callbacks){call("chart.getHypedArtists",params,callbacks)},getHypedTracks:function(params,session,callbacks){call("chart.getHypedTracks",params,callbacks)},getLovedTracks:function(params,session,callbacks){call("chart.getLovedTracks",params,callbacks)},getTopArtists:function(params,session,callbacks){call("chart.getTopArtists",params,callbacks)},getTopTags:function(params,session,callbacks){call("chart.getTopTags",params,callbacks)},getTopTracks:function(params,session,callbacks){call("chart.getTopTracks",params,callbacks)}};this.event={attend:function(params,session,callbacks){signedCall("event.attend",params,session,callbacks,"POST")},getAttendees:function(params,session,callbacks){call("event.getAttendees",params,callbacks)},getInfo:function(params,callbacks){call("event.getInfo",params,callbacks)},getShouts:function(params,callbacks){call("event.getShouts",params,callbacks)},share:function(params,session,callbacks){if(typeof params.recipient==="object"){params.recipient=params.recipient.join(",")}signedCall("event.share",params,session,callbacks,"POST")},shout:function(params,session,callbacks){signedCall("event.shout",params,session,callbacks,"POST")}};this.geo={getEvents:function(params,callbacks){call("geo.getEvents",params,callbacks)},getMetroArtistChart:function(params,callbacks){call("geo.getMetroArtistChart",params,callbacks)},getMetroHypeArtistChart:function(params,callbacks){call("geo.getMetroHypeArtistChart",params,callbacks)},getMetroHypeTrackChart:function(params,callbacks){call("geo.getMetroHypeTrackChart",params,callbacks)},getMetroTrackChart:function(params,callbacks){call("geo.getMetroTrackChart",params,callbacks)},getMetroUniqueArtistChart:function(params,callbacks){call("geo.getMetroUniqueArtistChart",params,callbacks)},getMetroUniqueTrackChart:function(params,callbacks){call("geo.getMetroUniqueTrackChart",params,callbacks)},getMetroWeeklyChartlist:function(params,callbacks){call("geo.getMetroWeeklyChartlist",params,callbacks)},getMetros:function(params,callbacks){call("geo.getMetros",params,callbacks)},getTopArtists:function(params,callbacks){call("geo.getTopArtists",params,callbacks)},getTopTracks:function(params,callbacks){call("geo.getTopTracks",params,callbacks)}};this.group={getHype:function(params,callbacks){call("group.getHype",params,callbacks)},getMembers:function(params,callbacks){call("group.getMembers",params,callbacks)},getWeeklyAlbumChart:function(params,callbacks){call("group.getWeeklyAlbumChart",params,callbacks)},getWeeklyArtistChart:function(params,callbacks){call("group.getWeeklyArtistChart",params,callbacks)},getWeeklyChartList:function(params,callbacks){call("group.getWeeklyChartList",params,callbacks)},getWeeklyTrackChart:function(params,callbacks){call("group.getWeeklyTrackChart",params,callbacks)}};this.library={addAlbum:function(params,session,callbacks){signedCall("library.addAlbum",params,session,callbacks,"POST")},addArtist:function(params,session,callbacks){signedCall("library.addArtist",params,session,callbacks,"POST")},addTrack:function(params,session,callbacks){signedCall("library.addTrack",params,session,callbacks,"POST")},getAlbums:function(params,callbacks){call("library.getAlbums",params,callbacks)},getArtists:function(params,callbacks){call("library.getArtists",params,callbacks)},getTracks:function(params,callbacks){call("library.getTracks",params,callbacks)}};this.playlist={addTrack:function(params,session,callbacks){signedCall("playlist.addTrack",params,session,callbacks,"POST")},create:function(params,session,callbacks){signedCall("playlist.create",params,session,callbacks,"POST")},fetch:function(params,callbacks){call("playlist.fetch",params,callbacks)}};this.radio={getPlaylist:function(params,session,callbacks){signedCall("radio.getPlaylist",params,session,callbacks)},search:function(params,session,callbacks){signedCall("radio.search",params,session,callbacks)},tune:function(params,session,callbacks){signedCall("radio.tune",params,session,callbacks)}};this.tag={getInfo:function(params,callbacks){call("tag.getInfo",params,callbacks)},getSimilar:function(params,callbacks){call("tag.getSimilar",params,callbacks)},getTopAlbums:function(params,callbacks){call("tag.getTopAlbums",params,callbacks)},getTopArtists:function(params,callbacks){call("tag.getTopArtists",params,callbacks)},getTopTags:function(callbacks){call("tag.getTopTags",null,callbacks)},getTopTracks:function(params,callbacks){call("tag.getTopTracks",params,callbacks)},getWeeklyArtistChart:function(params,callbacks){call("tag.getWeeklyArtistChart",params,callbacks)},getWeeklyChartList:function(params,callbacks){call("tag.getWeeklyChartList",params,callbacks)},search:function(params,callbacks){call("tag.search",params,callbacks)}};this.tasteometer={compare:function(params,callbacks){call("tasteometer.compare",params,callbacks)},compareGroup:function(params,callbacks){call("tasteometer.compareGroup",params,callbacks)}};this.track={addTags:function(params,session,callbacks){signedCall("track.addTags",params,session,callbacks,"POST")},ban:function(params,session,callbacks){signedCall("track.ban",params,session,callbacks,"POST")},getBuylinks:function(params,callbacks){call("track.getBuylinks",params,callbacks)},getCorrection:function(params,callbacks){call("track.getCorrection",params,callbacks)},getFingerprintMetadata:function(params,callbacks){call("track.getFingerprintMetadata",params,callbacks)},getInfo:function(params,callbacks){call("track.getInfo",params,callbacks)},getShouts:function(params,callbacks){call("track.getShouts",params,callbacks)},getSimilar:function(params,callbacks){call("track.getSimilar",params,callbacks)},getTags:function(params,session,callbacks){signedCall("track.getTags",params,session,callbacks)},getTopFans:function(params,callbacks){call("track.getTopFans",params,callbacks)},getTopTags:function(params,callbacks){call("track.getTopTags",params,callbacks)},love:function(params,session,callbacks){signedCall("track.love",params,session,callbacks,"POST")},removeTag:function(params,session,callbacks){signedCall("track.removeTag",params,session,callbacks,"POST")},scrobble:function(params,session,callbacks){if(params.constructor.toString().indexOf("Array")!==-1){var p={};var i;var j;for(i in params){if(params.hasOwnProperty(i)){for(j in params[i]){if(params[i].hasOwnProperty(j)){p[j+"["+i+"]"]=params[i][j]}}}}params=p}signedCall("track.scrobble",params,session,callbacks,"POST")},search:function(params,callbacks){call("track.search",params,callbacks)},share:function(params,session,callbacks){if(typeof params.recipient==="object"){params.recipient=params.recipient.join(",")}signedCall("track.share",params,session,callbacks,"POST")},unban:function(params,session,callbacks){signedCall("track.unban",params,session,callbacks,"POST")},unlove:function(params,session,callbacks){signedCall("track.unlove",params,session,callbacks,"POST")},updateNowPlaying:function(params,session,callbacks){signedCall("track.updateNowPlaying",params,session,callbacks,"POST")}};this.user={getArtistTracks:function(params,callbacks){call("user.getArtistTracks",params,callbacks)},getBannedTracks:function(params,callbacks){call("user.getBannedTracks",params,callbacks)},getEvents:function(params,callbacks){call("user.getEvents",params,callbacks)},getFriends:function(params,callbacks){call("user.getFriends",params,callbacks)},getInfo:function(params,callbacks){call("user.getInfo",params,callbacks)},getLovedTracks:function(params,callbacks){call("user.getLovedTracks",params,callbacks)},getNeighbours:function(params,callbacks){call("user.getNeighbours",params,callbacks)},getNewReleases:function(params,callbacks){call("user.getNewReleases",params,callbacks)},getPastEvents:function(params,callbacks){call("user.getPastEvents",params,callbacks)},getPersonalTracks:function(params,callbacks){call("user.getPersonalTracks",params,callbacks)},getPlaylists:function(params,callbacks){call("user.getPlaylists",params,callbacks)},getRecentStations:function(params,session,callbacks){signedCall("user.getRecentStations",params,session,callbacks)},getRecentTracks:function(params,callbacks){call("user.getRecentTracks",params,callbacks)},getRecommendedArtists:function(params,session,callbacks){signedCall("user.getRecommendedArtists",params,session,callbacks)},getRecommendedEvents:function(params,session,callbacks){signedCall("user.getRecommendedEvents",params,session,callbacks)},getShouts:function(params,callbacks){call("user.getShouts",params,callbacks)},getTopAlbums:function(params,callbacks){call("user.getTopAlbums",params,callbacks)},getTopArtists:function(params,callbacks){call("user.getTopArtists",params,callbacks)},getTopTags:function(params,callbacks){call("user.getTopTags",params,callbacks)},getTopTracks:function(params,callbacks){call("user.getTopTracks",params,callbacks)},getWeeklyAlbumChart:function(params,callbacks){call("user.getWeeklyAlbumChart",params,callbacks)},getWeeklyArtistChart:function(params,callbacks){call("user.getWeeklyArtistChart",params,callbacks)},getWeeklyChartList:function(params,callbacks){call("user.getWeeklyChartList",params,callbacks)},getWeeklyTrackChart:function(params,callbacks){call("user.getWeeklyTrackChart",params,callbacks)},shout:function(params,session,callbacks){signedCall("user.shout",params,session,callbacks,"POST")}};this.venue={getEvents:function(params,callbacks){call("venue.getEvents",params,callbacks)},getPastEvents:function(params,callbacks){call("venue.getPastEvents",params,callbacks)},search:function(params,callbacks){call("venue.search",params,callbacks)}};var auth={getApiSignature:function(params){var keys=[];var string="";var key;var index;for(key in params){if(params.hasOwnProperty(key)){keys.push(key)}}keys.sort();for(index in keys){if(keys.hasOwnProperty(index)){key=keys[index];string+=key+params[key]}}string+=apiSecret;return md5(string)}}}LastFM.Cache=Cache;module.exports=LastFM},{"./cache.js":49,crypto:55}],51:[function(_dereq_,module,exports){var base64=_dereq_("base64-js");var ieee754=_dereq_("ieee754");exports.Buffer=Buffer;exports.SlowBuffer=Buffer;exports.INSPECT_MAX_BYTES=50;Buffer.poolSize=8192;Buffer._useTypedArrays=function(){try{var buf=new ArrayBuffer(0);var arr=new Uint8Array(buf);arr.foo=function(){return 42};return 42===arr.foo()&&typeof arr.subarray==="function"}catch(e){return false}}();function Buffer(subject,encoding,noZero){if(!(this instanceof Buffer))return new Buffer(subject,encoding,noZero);var type=typeof subject;if(encoding==="base64"&&type==="string"){subject=stringtrim(subject);while(subject.length%4!==0){subject=subject+"="}}var length;if(type==="number")length=coerce(subject);else if(type==="string")length=Buffer.byteLength(subject,encoding);else if(type==="object")length=coerce(subject.length);else throw new Error("First argument needs to be a number, array or string.");var buf;if(Buffer._useTypedArrays){buf=Buffer._augment(new Uint8Array(length))}else{buf=this;buf.length=length;buf._isBuffer=true}var i;if(Buffer._useTypedArrays&&typeof subject.byteLength==="number"){buf._set(subject)}else if(isArrayish(subject)){for(i=0;i<length;i++){if(Buffer.isBuffer(subject))buf[i]=subject.readUInt8(i);else buf[i]=subject[i]}}else if(type==="string"){buf.write(subject,0,encoding)}else if(type==="number"&&!Buffer._useTypedArrays&&!noZero){for(i=0;i<length;i++){buf[i]=0}}return buf}Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.isBuffer=function(b){return!!(b!==null&&b!==undefined&&b._isBuffer)};Buffer.byteLength=function(str,encoding){var ret;str=str+"";switch(encoding||"utf8"){case"hex":ret=str.length/2;break;case"utf8":case"utf-8":ret=utf8ToBytes(str).length;break;case"ascii":case"binary":case"raw":ret=str.length;break;case"base64":ret=base64ToBytes(str).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=str.length*2;break;default:throw new Error("Unknown encoding")}return ret};Buffer.concat=function(list,totalLength){assert(isArray(list),"Usage: Buffer.concat(list, [totalLength])\n"+"list should be an Array.");if(list.length===0){return new Buffer(0)}else if(list.length===1){return list[0]}var i;if(typeof totalLength!=="number"){totalLength=0;for(i=0;i<list.length;i++){totalLength+=list[i].length}}var buf=new Buffer(totalLength);var pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos);pos+=item.length}return buf};function _hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;assert(strLen%2===0,"Invalid hex string");if(length>strLen/2){length=strLen/2}for(var i=0;i<length;i++){var byte=parseInt(string.substr(i*2,2),16);assert(!isNaN(byte),"Invalid hex string");buf[offset+i]=byte}Buffer._charsWritten=i*2;return i}function _utf8Write(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(utf8ToBytes(string),buf,offset,length);return charsWritten}function _asciiWrite(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(asciiToBytes(string),buf,offset,length);return charsWritten}function _binaryWrite(buf,string,offset,length){return _asciiWrite(buf,string,offset,length)}function _base64Write(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(base64ToBytes(string),buf,offset,length);return charsWritten}function _utf16leWrite(buf,string,offset,length){var charsWritten=Buffer._charsWritten=blitBuffer(utf16leToBytes(string),buf,offset,length);return charsWritten}Buffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset)){if(!isFinite(length)){encoding=length;length=undefined}}else{var swap=encoding;encoding=offset;offset=length;length=swap}offset=Number(offset)||0;var remaining=this.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}encoding=String(encoding||"utf8").toLowerCase();var ret;switch(encoding){case"hex":ret=_hexWrite(this,string,offset,length);break;case"utf8":case"utf-8":ret=_utf8Write(this,string,offset,length);break;case"ascii":ret=_asciiWrite(this,string,offset,length);break;case"binary":ret=_binaryWrite(this,string,offset,length);break;case"base64":ret=_base64Write(this,string,offset,length);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=_utf16leWrite(this,string,offset,length);
break;default:throw new Error("Unknown encoding")}return ret};Buffer.prototype.toString=function(encoding,start,end){var self=this;encoding=String(encoding||"utf8").toLowerCase();start=Number(start)||0;end=end!==undefined?Number(end):end=self.length;if(end===start)return"";var ret;switch(encoding){case"hex":ret=_hexSlice(self,start,end);break;case"utf8":case"utf-8":ret=_utf8Slice(self,start,end);break;case"ascii":ret=_asciiSlice(self,start,end);break;case"binary":ret=_binarySlice(self,start,end);break;case"base64":ret=_base64Slice(self,start,end);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=_utf16leSlice(self,start,end);break;default:throw new Error("Unknown encoding")}return ret};Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};Buffer.prototype.copy=function(target,target_start,start,end){var source=this;if(!start)start=0;if(!end&&end!==0)end=this.length;if(!target_start)target_start=0;if(end===start)return;if(target.length===0||source.length===0)return;assert(end>=start,"sourceEnd < sourceStart");assert(target_start>=0&&target_start<target.length,"targetStart out of bounds");assert(start>=0&&start<source.length,"sourceStart out of bounds");assert(end>=0&&end<=source.length,"sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-target_start<end-start)end=target.length-target_start+start;var len=end-start;if(len<100||!Buffer._useTypedArrays){for(var i=0;i<len;i++)target[i+target_start]=this[i+start]}else{target._set(this.subarray(start,start+len),target_start)}};function _base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function _utf8Slice(buf,start,end){var res="";var tmp="";end=Math.min(buf.length,end);for(var i=start;i<end;i++){if(buf[i]<=127){res+=decodeUtf8Char(tmp)+String.fromCharCode(buf[i]);tmp=""}else{tmp+="%"+buf[i].toString(16)}}return res+decodeUtf8Char(tmp)}function _asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++)ret+=String.fromCharCode(buf[i]);return ret}function _binarySlice(buf,start,end){return _asciiSlice(buf,start,end)}function _hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;i++){out+=toHex(buf[i])}return out}function _utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function(start,end){var len=this.length;start=clamp(start,len,0);end=clamp(end,len,len);if(Buffer._useTypedArrays){return Buffer._augment(this.subarray(start,end))}else{var sliceLen=end-start;var newBuf=new Buffer(sliceLen,undefined,true);for(var i=0;i<sliceLen;i++){newBuf[i]=this[i+start]}return newBuf}};Buffer.prototype.get=function(offset){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(offset)};Buffer.prototype.set=function(v,offset){console.log(".set() is deprecated. Access using array indexes instead.");return this.writeUInt8(v,offset)};Buffer.prototype.readUInt8=function(offset,noAssert){if(!noAssert){assert(offset!==undefined&&offset!==null,"missing offset");assert(offset<this.length,"Trying to read beyond buffer length")}if(offset>=this.length)return;return this[offset]};function _readUInt16(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val;if(littleEndian){val=buf[offset];if(offset+1<len)val|=buf[offset+1]<<8}else{val=buf[offset]<<8;if(offset+1<len)val|=buf[offset+1]}return val}Buffer.prototype.readUInt16LE=function(offset,noAssert){return _readUInt16(this,offset,true,noAssert)};Buffer.prototype.readUInt16BE=function(offset,noAssert){return _readUInt16(this,offset,false,noAssert)};function _readUInt32(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val;if(littleEndian){if(offset+2<len)val=buf[offset+2]<<16;if(offset+1<len)val|=buf[offset+1]<<8;val|=buf[offset];if(offset+3<len)val=val+(buf[offset+3]<<24>>>0)}else{if(offset+1<len)val=buf[offset+1]<<16;if(offset+2<len)val|=buf[offset+2]<<8;if(offset+3<len)val|=buf[offset+3];val=val+(buf[offset]<<24>>>0)}return val}Buffer.prototype.readUInt32LE=function(offset,noAssert){return _readUInt32(this,offset,true,noAssert)};Buffer.prototype.readUInt32BE=function(offset,noAssert){return _readUInt32(this,offset,false,noAssert)};Buffer.prototype.readInt8=function(offset,noAssert){if(!noAssert){assert(offset!==undefined&&offset!==null,"missing offset");assert(offset<this.length,"Trying to read beyond buffer length")}if(offset>=this.length)return;var neg=this[offset]&128;if(neg)return(255-this[offset]+1)*-1;else return this[offset]};function _readInt16(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val=_readUInt16(buf,offset,littleEndian,true);var neg=val&32768;if(neg)return(65535-val+1)*-1;else return val}Buffer.prototype.readInt16LE=function(offset,noAssert){return _readInt16(this,offset,true,noAssert)};Buffer.prototype.readInt16BE=function(offset,noAssert){return _readInt16(this,offset,false,noAssert)};function _readInt32(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"Trying to read beyond buffer length")}var len=buf.length;if(offset>=len)return;var val=_readUInt32(buf,offset,littleEndian,true);var neg=val&2147483648;if(neg)return(4294967295-val+1)*-1;else return val}Buffer.prototype.readInt32LE=function(offset,noAssert){return _readInt32(this,offset,true,noAssert)};Buffer.prototype.readInt32BE=function(offset,noAssert){return _readInt32(this,offset,false,noAssert)};function _readFloat(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset+3<buf.length,"Trying to read beyond buffer length")}return ieee754.read(buf,offset,littleEndian,23,4)}Buffer.prototype.readFloatLE=function(offset,noAssert){return _readFloat(this,offset,true,noAssert)};Buffer.prototype.readFloatBE=function(offset,noAssert){return _readFloat(this,offset,false,noAssert)};function _readDouble(buf,offset,littleEndian,noAssert){if(!noAssert){assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset+7<buf.length,"Trying to read beyond buffer length")}return ieee754.read(buf,offset,littleEndian,52,8)}Buffer.prototype.readDoubleLE=function(offset,noAssert){return _readDouble(this,offset,true,noAssert)};Buffer.prototype.readDoubleBE=function(offset,noAssert){return _readDouble(this,offset,false,noAssert)};Buffer.prototype.writeUInt8=function(value,offset,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset<this.length,"trying to write beyond buffer length");verifuint(value,255)}if(offset>=this.length)return;this[offset]=value};function _writeUInt16(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"trying to write beyond buffer length");verifuint(value,65535)}var len=buf.length;if(offset>=len)return;for(var i=0,j=Math.min(len-offset,2);i<j;i++){buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>(littleEndian?i:1-i)*8}}Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){_writeUInt16(this,value,offset,true,noAssert)};Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){_writeUInt16(this,value,offset,false,noAssert)};function _writeUInt32(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"trying to write beyond buffer length");verifuint(value,4294967295)}var len=buf.length;if(offset>=len)return;for(var i=0,j=Math.min(len-offset,4);i<j;i++){buf[offset+i]=value>>>(littleEndian?i:3-i)*8&255}}Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){_writeUInt32(this,value,offset,true,noAssert)};Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){_writeUInt32(this,value,offset,false,noAssert)};Buffer.prototype.writeInt8=function(value,offset,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset<this.length,"Trying to write beyond buffer length");verifsint(value,127,-128)}if(offset>=this.length)return;if(value>=0)this.writeUInt8(value,offset,noAssert);else this.writeUInt8(255+value+1,offset,noAssert)};function _writeInt16(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+1<buf.length,"Trying to write beyond buffer length");verifsint(value,32767,-32768)}var len=buf.length;if(offset>=len)return;if(value>=0)_writeUInt16(buf,value,offset,littleEndian,noAssert);else _writeUInt16(buf,65535+value+1,offset,littleEndian,noAssert)}Buffer.prototype.writeInt16LE=function(value,offset,noAssert){_writeInt16(this,value,offset,true,noAssert)};Buffer.prototype.writeInt16BE=function(value,offset,noAssert){_writeInt16(this,value,offset,false,noAssert)};function _writeInt32(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"Trying to write beyond buffer length");verifsint(value,2147483647,-2147483648)}var len=buf.length;if(offset>=len)return;if(value>=0)_writeUInt32(buf,value,offset,littleEndian,noAssert);else _writeUInt32(buf,4294967295+value+1,offset,littleEndian,noAssert)}Buffer.prototype.writeInt32LE=function(value,offset,noAssert){_writeInt32(this,value,offset,true,noAssert)};Buffer.prototype.writeInt32BE=function(value,offset,noAssert){_writeInt32(this,value,offset,false,noAssert)};function _writeFloat(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+3<buf.length,"Trying to write beyond buffer length");verifIEEE754(value,3.4028234663852886e38,-3.4028234663852886e38)}var len=buf.length;if(offset>=len)return;ieee754.write(buf,value,offset,littleEndian,23,4)}Buffer.prototype.writeFloatLE=function(value,offset,noAssert){_writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function(value,offset,noAssert){_writeFloat(this,value,offset,false,noAssert)};function _writeDouble(buf,value,offset,littleEndian,noAssert){if(!noAssert){assert(value!==undefined&&value!==null,"missing value");assert(typeof littleEndian==="boolean","missing or invalid endian");assert(offset!==undefined&&offset!==null,"missing offset");assert(offset+7<buf.length,"Trying to write beyond buffer length");verifIEEE754(value,1.7976931348623157e308,-1.7976931348623157e308)}var len=buf.length;if(offset>=len)return;ieee754.write(buf,value,offset,littleEndian,52,8)}Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){_writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){_writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.fill=function(value,start,end){if(!value)value=0;if(!start)start=0;if(!end)end=this.length;if(typeof value==="string"){value=value.charCodeAt(0)}assert(typeof value==="number"&&!isNaN(value),"value is not a number");assert(end>=start,"end < start");if(end===start)return;if(this.length===0)return;assert(start>=0&&start<this.length,"start out of bounds");assert(end>=0&&end<=this.length,"end out of bounds");for(var i=start;i<end;i++){this[i]=value}};Buffer.prototype.inspect=function(){var out=[];var len=this.length;for(var i=0;i<len;i++){out[i]=toHex(this[i]);if(i===exports.INSPECT_MAX_BYTES){out[i+1]="...";break}}return"<Buffer "+out.join(" ")+">"};Buffer.prototype.toArrayBuffer=function(){if(typeof Uint8Array!=="undefined"){if(Buffer._useTypedArrays){return new Buffer(this).buffer}else{var buf=new Uint8Array(this.length);for(var i=0,len=buf.length;i<len;i+=1)buf[i]=this[i];return buf.buffer}}else{throw new Error("Buffer.toArrayBuffer not supported in this browser")}};function stringtrim(str){if(str.trim)return str.trim();return str.replace(/^\s+|\s+$/g,"")}var BP=Buffer.prototype;Buffer._augment=function(arr){arr._isBuffer=true;arr._get=arr.get;arr._set=arr.set;arr.get=BP.get;arr.set=BP.set;arr.write=BP.write;arr.toString=BP.toString;arr.toLocaleString=BP.toString;arr.toJSON=BP.toJSON;arr.copy=BP.copy;arr.slice=BP.slice;arr.readUInt8=BP.readUInt8;arr.readUInt16LE=BP.readUInt16LE;arr.readUInt16BE=BP.readUInt16BE;arr.readUInt32LE=BP.readUInt32LE;arr.readUInt32BE=BP.readUInt32BE;arr.readInt8=BP.readInt8;arr.readInt16LE=BP.readInt16LE;arr.readInt16BE=BP.readInt16BE;arr.readInt32LE=BP.readInt32LE;arr.readInt32BE=BP.readInt32BE;arr.readFloatLE=BP.readFloatLE;arr.readFloatBE=BP.readFloatBE;arr.readDoubleLE=BP.readDoubleLE;arr.readDoubleBE=BP.readDoubleBE;arr.writeUInt8=BP.writeUInt8;arr.writeUInt16LE=BP.writeUInt16LE;arr.writeUInt16BE=BP.writeUInt16BE;arr.writeUInt32LE=BP.writeUInt32LE;arr.writeUInt32BE=BP.writeUInt32BE;arr.writeInt8=BP.writeInt8;arr.writeInt16LE=BP.writeInt16LE;arr.writeInt16BE=BP.writeInt16BE;arr.writeInt32LE=BP.writeInt32LE;arr.writeInt32BE=BP.writeInt32BE;arr.writeFloatLE=BP.writeFloatLE;arr.writeFloatBE=BP.writeFloatBE;arr.writeDoubleLE=BP.writeDoubleLE;arr.writeDoubleBE=BP.writeDoubleBE;arr.fill=BP.fill;arr.inspect=BP.inspect;arr.toArrayBuffer=BP.toArrayBuffer;return arr};function clamp(index,len,defaultValue){if(typeof index!=="number")return defaultValue;index=~~index;if(index>=len)return len;if(index>=0)return index;index+=len;if(index>=0)return index;return 0}function coerce(length){length=~~Math.ceil(+length);return length<0?0:length}function isArray(subject){return(Array.isArray||function(subject){return Object.prototype.toString.call(subject)==="[object Array]"})(subject)}function isArrayish(subject){return isArray(subject)||Buffer.isBuffer(subject)||subject&&typeof subject==="object"&&typeof subject.length==="number"}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++){var b=str.charCodeAt(i);if(b<=127)byteArray.push(str.charCodeAt(i));else{var start=i;if(b>=55296&&b<=57343)i++;var h=encodeURIComponent(str.slice(start,i+1)).substr(1).split("%");for(var j=0;j<h.length;j++)byteArray.push(parseInt(h[j],16))}}return byteArray}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;i++){c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(str)}function blitBuffer(src,dst,offset,length){var pos;for(var i=0;i<length;i++){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function decodeUtf8Char(str){try{return decodeURIComponent(str)}catch(err){return String.fromCharCode(65533)}}function verifuint(value,max){assert(typeof value==="number","cannot write a non-number as a number");assert(value>=0,"specified a negative value for writing an unsigned value");assert(value<=max,"value is larger than maximum value for type");assert(Math.floor(value)===value,"value has a fractional component")}function verifsint(value,max,min){assert(typeof value==="number","cannot write a non-number as a number");assert(value<=max,"value larger than maximum allowed value");assert(value>=min,"value smaller than minimum allowed value");assert(Math.floor(value)===value,"value has a fractional component")}function verifIEEE754(value,max,min){assert(typeof value==="number","cannot write a non-number as a number");assert(value<=max,"value larger than maximum allowed value");assert(value>=min,"value smaller than minimum allowed value")}function assert(test,message){if(!test)throw new Error(message||"Failed assertion")}},{"base64-js":52,ieee754:53}],52:[function(_dereq_,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(exports){"use strict";var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var PLUS="+".charCodeAt(0);var SLASH="/".charCodeAt(0);var NUMBER="0".charCodeAt(0);var LOWER="a".charCodeAt(0);var UPPER="A".charCodeAt(0);function decode(elt){var code=elt.charCodeAt(0);if(code===PLUS)return 62;if(code===SLASH)return 63;if(code<NUMBER)return-1;if(code<NUMBER+10)return code-NUMBER+26+26;if(code<UPPER+26)return code-UPPER;if(code<LOWER+26)return code-LOWER+26}function b64ToByteArray(b64){var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0;arr=new Arr(b64.length*3/4-placeHolders);l=placeHolders>0?b64.length-4:b64.length;var L=0;function push(v){arr[L++]=v}for(i=0,j=0;i<l;i+=4,j+=3){tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3));push((tmp&16711680)>>16);push((tmp&65280)>>8);push(tmp&255)}if(placeHolders===2){tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4;push(tmp&255)}else if(placeHolders===1){tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2;push(tmp>>8&255);push(tmp&255)}return arr}function uint8ToBase64(uint8){var i,extraBytes=uint8.length%3,output="",temp,length;function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(num&63)}for(i=0,length=uint8.length-extraBytes;i<length;i+=3){temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2];output+=tripletToBase64(temp)}switch(extraBytes){case 1:temp=uint8[uint8.length-1];output+=encode(temp>>2);output+=encode(temp<<4&63);output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1];output+=encode(temp>>10);output+=encode(temp>>4&63);output+=encode(temp<<2&63);output+="=";break}return output}exports.toByteArray=b64ToByteArray;exports.fromByteArray=uint8ToBase64})(typeof exports==="undefined"?this.base64js={}:exports)},{}],53:[function(_dereq_,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=nBytes*8-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8);m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8);if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=nBytes*8-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8);e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=s*128}},{}],54:[function(_dereq_,module,exports){var Buffer=_dereq_("buffer").Buffer;var intSize=4;var zeroBuffer=new Buffer(intSize);zeroBuffer.fill(0);var chrsz=8;function toArray(buf,bigEndian){if(buf.length%intSize!==0){var len=buf.length+(intSize-buf.length%intSize);buf=Buffer.concat([buf,zeroBuffer],len)}var arr=[];var fn=bigEndian?buf.readInt32BE:buf.readInt32LE;for(var i=0;i<buf.length;i+=intSize){arr.push(fn.call(buf,i))}return arr}function toBuffer(arr,size,bigEndian){var buf=new Buffer(size);var fn=bigEndian?buf.writeInt32BE:buf.writeInt32LE;for(var i=0;i<arr.length;i++){fn.call(buf,arr[i],i*4,true)}return buf}function hash(buf,fn,hashSize,bigEndian){if(!Buffer.isBuffer(buf))buf=new Buffer(buf);var arr=fn(toArray(buf,bigEndian),buf.length*chrsz);return toBuffer(arr,hashSize,bigEndian)}module.exports={hash:hash}},{buffer:51}],55:[function(_dereq_,module,exports){var Buffer=_dereq_("buffer").Buffer;var sha=_dereq_("./sha");var sha256=_dereq_("./sha256");var rng=_dereq_("./rng");var md5=_dereq_("./md5");var algorithms={sha1:sha,sha256:sha256,md5:md5};var blocksize=64;var zeroBuffer=new Buffer(blocksize);zeroBuffer.fill(0);function hmac(fn,key,data){if(!Buffer.isBuffer(key))key=new Buffer(key);if(!Buffer.isBuffer(data))data=new Buffer(data);if(key.length>blocksize){key=fn(key)}else if(key.length<blocksize){key=Buffer.concat([key,zeroBuffer],blocksize)}var ipad=new Buffer(blocksize),opad=new Buffer(blocksize);for(var i=0;i<blocksize;i++){ipad[i]=key[i]^54;opad[i]=key[i]^92}var hash=fn(Buffer.concat([ipad,data]));return fn(Buffer.concat([opad,hash]))}function hash(alg,key){alg=alg||"sha1";var fn=algorithms[alg];var bufs=[];var length=0;if(!fn)error("algorithm:",alg,"is not yet supported");return{update:function(data){if(!Buffer.isBuffer(data))data=new Buffer(data);bufs.push(data);length+=data.length;return this},digest:function(enc){var buf=Buffer.concat(bufs);var r=key?hmac(fn,key,buf):fn(buf);bufs=null;return enc?r.toString(enc):r}}}function error(){var m=[].slice.call(arguments).join(" ");throw new Error([m,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}exports.createHash=function(alg){return hash(alg)};exports.createHmac=function(alg,key){return hash(alg,key)};exports.randomBytes=function(size,callback){if(callback&&callback.call){try{callback.call(this,undefined,new Buffer(rng(size)))}catch(err){callback(err)}}else{return new Buffer(rng(size))}};function each(a,f){for(var i in a)f(a[i],i)}each(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],function(name){exports[name]=function(){error("sorry,",name,"is not implemented yet")}})},{"./md5":56,"./rng":57,"./sha":58,"./sha256":59,buffer:51}],56:[function(_dereq_,module,exports){var helpers=_dereq_("./helpers");function md5_vm_test(){return hex_md5("abc")=="900150983cd24fb0d6963f7d28e17f72"}function core_md5(x,len){x[len>>5]|=128<<len%32;x[(len+64>>>9<<4)+14]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;a=md5_ff(a,b,c,d,x[i+0],7,-680876936);d=md5_ff(d,a,b,c,x[i+1],12,-389564586);c=md5_ff(c,d,a,b,x[i+2],17,606105819);b=md5_ff(b,c,d,a,x[i+3],22,-1044525330);a=md5_ff(a,b,c,d,x[i+4],7,-176418897);d=md5_ff(d,a,b,c,x[i+5],12,1200080426);c=md5_ff(c,d,a,b,x[i+6],17,-1473231341);b=md5_ff(b,c,d,a,x[i+7],22,-45705983);a=md5_ff(a,b,c,d,x[i+8],7,1770035416);d=md5_ff(d,a,b,c,x[i+9],12,-1958414417);c=md5_ff(c,d,a,b,x[i+10],17,-42063);b=md5_ff(b,c,d,a,x[i+11],22,-1990404162);a=md5_ff(a,b,c,d,x[i+12],7,1804603682);d=md5_ff(d,a,b,c,x[i+13],12,-40341101);c=md5_ff(c,d,a,b,x[i+14],17,-1502002290);b=md5_ff(b,c,d,a,x[i+15],22,1236535329);a=md5_gg(a,b,c,d,x[i+1],5,-165796510);d=md5_gg(d,a,b,c,x[i+6],9,-1069501632);c=md5_gg(c,d,a,b,x[i+11],14,643717713);b=md5_gg(b,c,d,a,x[i+0],20,-373897302);a=md5_gg(a,b,c,d,x[i+5],5,-701558691);d=md5_gg(d,a,b,c,x[i+10],9,38016083);c=md5_gg(c,d,a,b,x[i+15],14,-660478335);b=md5_gg(b,c,d,a,x[i+4],20,-405537848);a=md5_gg(a,b,c,d,x[i+9],5,568446438);d=md5_gg(d,a,b,c,x[i+14],9,-1019803690);c=md5_gg(c,d,a,b,x[i+3],14,-187363961);b=md5_gg(b,c,d,a,x[i+8],20,1163531501);a=md5_gg(a,b,c,d,x[i+13],5,-1444681467);d=md5_gg(d,a,b,c,x[i+2],9,-51403784);c=md5_gg(c,d,a,b,x[i+7],14,1735328473);b=md5_gg(b,c,d,a,x[i+12],20,-1926607734);a=md5_hh(a,b,c,d,x[i+5],4,-378558);d=md5_hh(d,a,b,c,x[i+8],11,-2022574463);c=md5_hh(c,d,a,b,x[i+11],16,1839030562);b=md5_hh(b,c,d,a,x[i+14],23,-35309556);a=md5_hh(a,b,c,d,x[i+1],4,-1530992060);d=md5_hh(d,a,b,c,x[i+4],11,1272893353);c=md5_hh(c,d,a,b,x[i+7],16,-155497632);b=md5_hh(b,c,d,a,x[i+10],23,-1094730640);a=md5_hh(a,b,c,d,x[i+13],4,681279174);d=md5_hh(d,a,b,c,x[i+0],11,-358537222);c=md5_hh(c,d,a,b,x[i+3],16,-722521979);b=md5_hh(b,c,d,a,x[i+6],23,76029189);a=md5_hh(a,b,c,d,x[i+9],4,-640364487);d=md5_hh(d,a,b,c,x[i+12],11,-421815835);c=md5_hh(c,d,a,b,x[i+15],16,530742520);b=md5_hh(b,c,d,a,x[i+2],23,-995338651);a=md5_ii(a,b,c,d,x[i+0],6,-198630844);d=md5_ii(d,a,b,c,x[i+7],10,1126891415);c=md5_ii(c,d,a,b,x[i+14],15,-1416354905);b=md5_ii(b,c,d,a,x[i+5],21,-57434055);a=md5_ii(a,b,c,d,x[i+12],6,1700485571);d=md5_ii(d,a,b,c,x[i+3],10,-1894986606);c=md5_ii(c,d,a,b,x[i+10],15,-1051523);b=md5_ii(b,c,d,a,x[i+1],21,-2054922799);a=md5_ii(a,b,c,d,x[i+8],6,1873313359);d=md5_ii(d,a,b,c,x[i+15],10,-30611744);c=md5_ii(c,d,a,b,x[i+6],15,-1560198380);b=md5_ii(b,c,d,a,x[i+13],21,1309151649);a=md5_ii(a,b,c,d,x[i+4],6,-145523070);d=md5_ii(d,a,b,c,x[i+11],10,-1120210379);c=md5_ii(c,d,a,b,x[i+2],15,718787259);b=md5_ii(b,c,d,a,x[i+9],21,-343485551);a=safe_add(a,olda);b=safe_add(b,oldb);c=safe_add(c,oldc);d=safe_add(d,oldd)}return Array(a,b,c,d)}function md5_cmn(q,a,b,x,s,t){return safe_add(bit_rol(safe_add(safe_add(a,q),safe_add(x,t)),s),b)}function md5_ff(a,b,c,d,x,s,t){return md5_cmn(b&c|~b&d,a,b,x,s,t)}function md5_gg(a,b,c,d,x,s,t){return md5_cmn(b&d|c&~d,a,b,x,s,t)}function md5_hh(a,b,c,d,x,s,t){return md5_cmn(b^c^d,a,b,x,s,t)}function md5_ii(a,b,c,d,x,s,t){return md5_cmn(c^(b|~d),a,b,x,s,t)}function safe_add(x,y){var lsw=(x&65535)+(y&65535);var msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|lsw&65535}function bit_rol(num,cnt){return num<<cnt|num>>>32-cnt}module.exports=function md5(buf){return helpers.hash(buf,core_md5,16)}},{"./helpers":54}],57:[function(_dereq_,module,exports){(function(){var _global=this;var mathRNG,whatwgRNG;mathRNG=function(size){var bytes=new Array(size);var r;for(var i=0,r;i<size;i++){if((i&3)==0)r=Math.random()*4294967296;bytes[i]=r>>>((i&3)<<3)&255}return bytes};if(_global.crypto&&crypto.getRandomValues){whatwgRNG=function(size){var bytes=new Uint8Array(size);crypto.getRandomValues(bytes);return bytes}}module.exports=whatwgRNG||mathRNG})()},{}],58:[function(_dereq_,module,exports){var helpers=_dereq_("./helpers");function core_sha1(x,len){x[len>>5]|=128<<24-len%32;x[(len+64>>9<<4)+15]=len;var w=Array(80);var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;var e=-1009589776;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;var olde=e;for(var j=0;j<80;j++){if(j<16)w[j]=x[i+j];else w[j]=rol(w[j-3]^w[j-8]^w[j-14]^w[j-16],1);var t=safe_add(safe_add(rol(a,5),sha1_ft(j,b,c,d)),safe_add(safe_add(e,w[j]),sha1_kt(j)));e=d;d=c;c=rol(b,30);b=a;a=t}a=safe_add(a,olda);b=safe_add(b,oldb);c=safe_add(c,oldc);d=safe_add(d,oldd);e=safe_add(e,olde)}return Array(a,b,c,d,e)}function sha1_ft(t,b,c,d){if(t<20)return b&c|~b&d;if(t<40)return b^c^d;if(t<60)return b&c|b&d|c&d;return b^c^d}function sha1_kt(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514}function safe_add(x,y){var lsw=(x&65535)+(y&65535);var msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|lsw&65535}function rol(num,cnt){return num<<cnt|num>>>32-cnt}module.exports=function sha1(buf){return helpers.hash(buf,core_sha1,20,true)}},{"./helpers":54}],59:[function(_dereq_,module,exports){var helpers=_dereq_("./helpers");var safe_add=function(x,y){var lsw=(x&65535)+(y&65535);var msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|lsw&65535};var S=function(X,n){return X>>>n|X<<32-n};var R=function(X,n){return X>>>n};var Ch=function(x,y,z){return x&y^~x&z};var Maj=function(x,y,z){return x&y^x&z^y&z};var Sigma0256=function(x){return S(x,2)^S(x,13)^S(x,22)};var Sigma1256=function(x){return S(x,6)^S(x,11)^S(x,25)};var Gamma0256=function(x){return S(x,7)^S(x,18)^R(x,3)};var Gamma1256=function(x){return S(x,17)^S(x,19)^R(x,10)};var core_sha256=function(m,l){var K=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298);var HASH=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225);var W=new Array(64);var a,b,c,d,e,f,g,h,i,j;var T1,T2;m[l>>5]|=128<<24-l%32;m[(l+64>>9<<4)+15]=l;for(var i=0;i<m.length;i+=16){a=HASH[0];b=HASH[1];c=HASH[2];d=HASH[3];e=HASH[4];f=HASH[5];g=HASH[6];h=HASH[7];for(var j=0;j<64;j++){if(j<16){W[j]=m[j+i]}else{W[j]=safe_add(safe_add(safe_add(Gamma1256(W[j-2]),W[j-7]),Gamma0256(W[j-15])),W[j-16])}T1=safe_add(safe_add(safe_add(safe_add(h,Sigma1256(e)),Ch(e,f,g)),K[j]),W[j]);T2=safe_add(Sigma0256(a),Maj(a,b,c));h=g;g=f;f=e;e=safe_add(d,T1);d=c;c=b;b=a;a=safe_add(T1,T2)}HASH[0]=safe_add(a,HASH[0]);HASH[1]=safe_add(b,HASH[1]);HASH[2]=safe_add(c,HASH[2]);HASH[3]=safe_add(d,HASH[3]);HASH[4]=safe_add(e,HASH[4]);HASH[5]=safe_add(f,HASH[5]);HASH[6]=safe_add(g,HASH[6]);HASH[7]=safe_add(h,HASH[7])}return HASH};module.exports=function sha256(buf){return helpers.hash(buf,core_sha256,32,true)}},{"./helpers":54}],60:[function(_dereq_,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate){return function(f){return window.setImmediate(f)}}if(canPost){var queue=[];window.addEventListener("message",function(ev){var source=ev.source;if((source===window||source===null)&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported")
};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}],61:[function(_dereq_,module,exports){"use strict";var base=_dereq_("./handlebars/base");var SafeString=_dereq_("./handlebars/safe-string")["default"];var Exception=_dereq_("./handlebars/exception")["default"];var Utils=_dereq_("./handlebars/utils");var runtime=_dereq_("./handlebars/runtime");var create=function(){var hb=new base.HandlebarsEnvironment;Utils.extend(hb,base);hb.SafeString=SafeString;hb.Exception=Exception;hb.Utils=Utils;hb.VM=runtime;hb.template=function(spec){return runtime.template(spec,hb)};return hb};var Handlebars=create();Handlebars.create=create;exports["default"]=Handlebars},{"./handlebars/base":62,"./handlebars/exception":63,"./handlebars/runtime":64,"./handlebars/safe-string":65,"./handlebars/utils":66}],62:[function(_dereq_,module,exports){"use strict";var Utils=_dereq_("./utils");var Exception=_dereq_("./exception")["default"];var VERSION="1.3.0";exports.VERSION=VERSION;var COMPILER_REVISION=4;exports.COMPILER_REVISION=COMPILER_REVISION;var REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};exports.REVISION_CHANGES=REVISION_CHANGES;var isArray=Utils.isArray,isFunction=Utils.isFunction,toString=Utils.toString,objectType="[object Object]";function HandlebarsEnvironment(helpers,partials){this.helpers=helpers||{};this.partials=partials||{};registerDefaultHelpers(this)}exports.HandlebarsEnvironment=HandlebarsEnvironment;HandlebarsEnvironment.prototype={constructor:HandlebarsEnvironment,logger:logger,log:log,registerHelper:function(name,fn,inverse){if(toString.call(name)===objectType){if(inverse||fn){throw new Exception("Arg not supported with multiple helpers")}Utils.extend(this.helpers,name)}else{if(inverse){fn.not=inverse}this.helpers[name]=fn}},registerPartial:function(name,str){if(toString.call(name)===objectType){Utils.extend(this.partials,name)}else{this.partials[name]=str}}};function registerDefaultHelpers(instance){instance.registerHelper("helperMissing",function(arg){if(arguments.length===2){return undefined}else{throw new Exception("Missing helper: '"+arg+"'")}});instance.registerHelper("blockHelperMissing",function(context,options){var inverse=options.inverse||function(){},fn=options.fn;if(isFunction(context)){context=context.call(this)}if(context===true){return fn(this)}else if(context===false||context==null){return inverse(this)}else if(isArray(context)){if(context.length>0){return instance.helpers.each(context,options)}else{return inverse(this)}}else{return fn(context)}});instance.registerHelper("each",function(context,options){var fn=options.fn,inverse=options.inverse;var i=0,ret="",data;if(isFunction(context)){context=context.call(this)}if(options.data){data=createFrame(options.data)}if(context&&typeof context==="object"){if(isArray(context)){for(var j=context.length;i<j;i++){if(data){data.index=i;data.first=i===0;data.last=i===context.length-1}ret=ret+fn(context[i],{data:data})}}else{for(var key in context){if(context.hasOwnProperty(key)){if(data){data.key=key;data.index=i;data.first=i===0}ret=ret+fn(context[key],{data:data});i++}}}}if(i===0){ret=inverse(this)}return ret});instance.registerHelper("if",function(conditional,options){if(isFunction(conditional)){conditional=conditional.call(this)}if(!options.hash.includeZero&&!conditional||Utils.isEmpty(conditional)){return options.inverse(this)}else{return options.fn(this)}});instance.registerHelper("unless",function(conditional,options){return instance.helpers["if"].call(this,conditional,{fn:options.inverse,inverse:options.fn,hash:options.hash})});instance.registerHelper("with",function(context,options){if(isFunction(context)){context=context.call(this)}if(!Utils.isEmpty(context))return options.fn(context)});instance.registerHelper("log",function(context,options){var level=options.data&&options.data.level!=null?parseInt(options.data.level,10):1;instance.log(level,context)})}var logger={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(level,obj){if(logger.level<=level){var method=logger.methodMap[level];if(typeof console!=="undefined"&&console[method]){console[method].call(console,obj)}}}};exports.logger=logger;function log(level,obj){logger.log(level,obj)}exports.log=log;var createFrame=function(object){var obj={};Utils.extend(obj,object);return obj};exports.createFrame=createFrame},{"./exception":63,"./utils":66}],63:[function(_dereq_,module,exports){"use strict";var errorProps=["description","fileName","lineNumber","message","name","number","stack"];function Exception(message,node){var line;if(node&&node.firstLine){line=node.firstLine;message+=" - "+line+":"+node.firstColumn}var tmp=Error.prototype.constructor.call(this,message);for(var idx=0;idx<errorProps.length;idx++){this[errorProps[idx]]=tmp[errorProps[idx]]}if(line){this.lineNumber=line;this.column=node.firstColumn}}Exception.prototype=new Error;exports["default"]=Exception},{}],64:[function(_dereq_,module,exports){"use strict";var Utils=_dereq_("./utils");var Exception=_dereq_("./exception")["default"];var COMPILER_REVISION=_dereq_("./base").COMPILER_REVISION;var REVISION_CHANGES=_dereq_("./base").REVISION_CHANGES;function checkRevision(compilerInfo){var compilerRevision=compilerInfo&&compilerInfo[0]||1,currentRevision=COMPILER_REVISION;if(compilerRevision!==currentRevision){if(compilerRevision<currentRevision){var runtimeVersions=REVISION_CHANGES[currentRevision],compilerVersions=REVISION_CHANGES[compilerRevision];throw new Exception("Template was precompiled with an older version of Handlebars than the current runtime. "+"Please update your precompiler to a newer version ("+runtimeVersions+") or downgrade your runtime to an older version ("+compilerVersions+").")}else{throw new Exception("Template was precompiled with a newer version of Handlebars than the current runtime. "+"Please update your runtime to a newer version ("+compilerInfo[1]+").")}}}exports.checkRevision=checkRevision;function template(templateSpec,env){if(!env){throw new Exception("No environment passed to template")}var invokePartialWrapper=function(partial,name,context,helpers,partials,data){var result=env.VM.invokePartial.apply(this,arguments);if(result!=null){return result}if(env.compile){var options={helpers:helpers,partials:partials,data:data};partials[name]=env.compile(partial,{data:data!==undefined},env);return partials[name](context,options)}else{throw new Exception("The partial "+name+" could not be compiled when running in runtime-only mode")}};var container={escapeExpression:Utils.escapeExpression,invokePartial:invokePartialWrapper,programs:[],program:function(i,fn,data){var programWrapper=this.programs[i];if(data){programWrapper=program(i,fn,data)}else if(!programWrapper){programWrapper=this.programs[i]=program(i,fn)}return programWrapper},merge:function(param,common){var ret=param||common;if(param&&common&&param!==common){ret={};Utils.extend(ret,common);Utils.extend(ret,param)}return ret},programWithDepth:env.VM.programWithDepth,noop:env.VM.noop,compilerInfo:null};return function(context,options){options=options||{};var namespace=options.partial?options:env,helpers,partials;if(!options.partial){helpers=options.helpers;partials=options.partials}var result=templateSpec.call(container,namespace,context,helpers,partials,options.data);if(!options.partial){env.VM.checkRevision(container.compilerInfo)}return result}}exports.template=template;function programWithDepth(i,fn,data){var args=Array.prototype.slice.call(arguments,3);var prog=function(context,options){options=options||{};return fn.apply(this,[context,options.data||data].concat(args))};prog.program=i;prog.depth=args.length;return prog}exports.programWithDepth=programWithDepth;function program(i,fn,data){var prog=function(context,options){options=options||{};return fn(context,options.data||data)};prog.program=i;prog.depth=0;return prog}exports.program=program;function invokePartial(partial,name,context,helpers,partials,data){var options={partial:true,helpers:helpers,partials:partials,data:data};if(partial===undefined){throw new Exception("The partial "+name+" could not be found")}else if(partial instanceof Function){return partial(context,options)}}exports.invokePartial=invokePartial;function noop(){return""}exports.noop=noop},{"./base":62,"./exception":63,"./utils":66}],65:[function(_dereq_,module,exports){"use strict";function SafeString(string){this.string=string}SafeString.prototype.toString=function(){return""+this.string};exports["default"]=SafeString},{}],66:[function(_dereq_,module,exports){"use strict";var SafeString=_dereq_("./safe-string")["default"];var escape={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var badChars=/[&<>"'`]/g;var possible=/[&<>"'`]/;function escapeChar(chr){return escape[chr]||"&amp;"}function extend(obj,value){for(var key in value){if(Object.prototype.hasOwnProperty.call(value,key)){obj[key]=value[key]}}}exports.extend=extend;var toString=Object.prototype.toString;exports.toString=toString;var isFunction=function(value){return typeof value==="function"};if(isFunction(/x/)){isFunction=function(value){return typeof value==="function"&&toString.call(value)==="[object Function]"}}var isFunction;exports.isFunction=isFunction;var isArray=Array.isArray||function(value){return value&&typeof value==="object"?toString.call(value)==="[object Array]":false};exports.isArray=isArray;function escapeExpression(string){if(string instanceof SafeString){return string.toString()}else if(!string&&string!==0){return""}string=""+string;if(!possible.test(string)){return string}return string.replace(badChars,escapeChar)}exports.escapeExpression=escapeExpression;function isEmpty(value){if(!value&&value!==0){return true}else if(isArray(value)&&value.length===0){return true}else{return false}}exports.isEmpty=isEmpty},{"./safe-string":65}],67:[function(_dereq_,module,exports){module.exports=_dereq_("./dist/cjs/handlebars.runtime")},{"./dist/cjs/handlebars.runtime":61}],68:[function(_dereq_,module,exports){(function(global){(function(){var block={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:noop,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:noop,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:noop,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};block.bullet=/(?:[*+-]|\d+\.)/;block.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/;block.item=replace(block.item,"gm")(/bull/g,block.bullet)();block.list=replace(block.list)(/bull/g,block.bullet)("hr",/\n+(?=(?: *[-*_]){3,} *(?:\n+|$))/)();block._tag="(?!(?:"+"a|em|strong|small|s|cite|q|dfn|abbr|data|time|code"+"|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo"+"|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|@)\\b";block.html=replace(block.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,block._tag)();block.paragraph=replace(block.paragraph)("hr",block.hr)("heading",block.heading)("lheading",block.lheading)("blockquote",block.blockquote)("tag","<"+block._tag)("def",block.def)();block.normal=merge({},block);block.gfm=merge({},block.normal,{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/});block.gfm.paragraph=replace(block.paragraph)("(?!","(?!"+block.gfm.fences.source.replace("\\1","\\2")+"|"+block.list.source.replace("\\1","\\3")+"|")();block.tables=merge({},block.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/});function Lexer(options){this.tokens=[];this.tokens.links={};this.options=options||marked.defaults;this.rules=block.normal;if(this.options.gfm){if(this.options.tables){this.rules=block.tables}else{this.rules=block.gfm}}}Lexer.rules=block;Lexer.lex=function(src,options){var lexer=new Lexer(options);return lexer.lex(src)};Lexer.prototype.lex=function(src){src=src.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n");return this.token(src,true)};Lexer.prototype.token=function(src,top){var src=src.replace(/^ +$/gm,""),next,loose,cap,bull,b,item,space,i,l;while(src){if(cap=this.rules.newline.exec(src)){src=src.substring(cap[0].length);if(cap[0].length>1){this.tokens.push({type:"space"})}}if(cap=this.rules.code.exec(src)){src=src.substring(cap[0].length);cap=cap[0].replace(/^ {4}/gm,"");this.tokens.push({type:"code",text:!this.options.pedantic?cap.replace(/\n+$/,""):cap});continue}if(cap=this.rules.fences.exec(src)){src=src.substring(cap[0].length);this.tokens.push({type:"code",lang:cap[2],text:cap[3]});continue}if(cap=this.rules.heading.exec(src)){src=src.substring(cap[0].length);this.tokens.push({type:"heading",depth:cap[1].length,text:cap[2]});continue}if(top&&(cap=this.rules.nptable.exec(src))){src=src.substring(cap[0].length);item={type:"table",header:cap[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:cap[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:cap[3].replace(/\n$/,"").split("\n")};for(i=0;i<item.align.length;i++){if(/^ *-+: *$/.test(item.align[i])){item.align[i]="right"}else if(/^ *:-+: *$/.test(item.align[i])){item.align[i]="center"}else if(/^ *:-+ *$/.test(item.align[i])){item.align[i]="left"}else{item.align[i]=null}}for(i=0;i<item.cells.length;i++){item.cells[i]=item.cells[i].split(/ *\| */)}this.tokens.push(item);continue}if(cap=this.rules.lheading.exec(src)){src=src.substring(cap[0].length);this.tokens.push({type:"heading",depth:cap[2]==="="?1:2,text:cap[1]});continue}if(cap=this.rules.hr.exec(src)){src=src.substring(cap[0].length);this.tokens.push({type:"hr"});continue}if(cap=this.rules.blockquote.exec(src)){src=src.substring(cap[0].length);this.tokens.push({type:"blockquote_start"});cap=cap[0].replace(/^ *> ?/gm,"");this.token(cap,top);this.tokens.push({type:"blockquote_end"});continue}if(cap=this.rules.list.exec(src)){src=src.substring(cap[0].length);bull=cap[2];this.tokens.push({type:"list_start",ordered:bull.length>1});cap=cap[0].match(this.rules.item);next=false;l=cap.length;i=0;for(;i<l;i++){item=cap[i];space=item.length;item=item.replace(/^ *([*+-]|\d+\.) +/,"");if(~item.indexOf("\n ")){space-=item.length;item=!this.options.pedantic?item.replace(new RegExp("^ {1,"+space+"}","gm"),""):item.replace(/^ {1,4}/gm,"")}if(this.options.smartLists&&i!==l-1){b=block.bullet.exec(cap[i+1])[0];if(bull!==b&&!(bull.length>1&&b.length>1)){src=cap.slice(i+1).join("\n")+src;i=l-1}}loose=next||/\n\n(?!\s*$)/.test(item);if(i!==l-1){next=item.charAt(item.length-1)==="\n";if(!loose)loose=next}this.tokens.push({type:loose?"loose_item_start":"list_item_start"});this.token(item,false);this.tokens.push({type:"list_item_end"})}this.tokens.push({type:"list_end"});continue}if(cap=this.rules.html.exec(src)){src=src.substring(cap[0].length);this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:cap[1]==="pre"||cap[1]==="script"||cap[1]==="style",text:cap[0]});continue}if(top&&(cap=this.rules.def.exec(src))){src=src.substring(cap[0].length);this.tokens.links[cap[1].toLowerCase()]={href:cap[2],title:cap[3]};continue}if(top&&(cap=this.rules.table.exec(src))){src=src.substring(cap[0].length);item={type:"table",header:cap[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:cap[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:cap[3].replace(/(?: *\| *)?\n$/,"").split("\n")};for(i=0;i<item.align.length;i++){if(/^ *-+: *$/.test(item.align[i])){item.align[i]="right"}else if(/^ *:-+: *$/.test(item.align[i])){item.align[i]="center"}else if(/^ *:-+ *$/.test(item.align[i])){item.align[i]="left"}else{item.align[i]=null}}for(i=0;i<item.cells.length;i++){item.cells[i]=item.cells[i].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */)}this.tokens.push(item);continue}if(top&&(cap=this.rules.paragraph.exec(src))){src=src.substring(cap[0].length);this.tokens.push({type:"paragraph",text:cap[1].charAt(cap[1].length-1)==="\n"?cap[1].slice(0,-1):cap[1]});continue}if(cap=this.rules.text.exec(src)){src=src.substring(cap[0].length);this.tokens.push({type:"text",text:cap[0]});continue}if(src){throw new Error("Infinite loop on byte: "+src.charCodeAt(0))}}return this.tokens};var inline={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:noop,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:noop,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};inline._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/;inline._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/;inline.link=replace(inline.link)("inside",inline._inside)("href",inline._href)();inline.reflink=replace(inline.reflink)("inside",inline._inside)();inline.normal=merge({},inline);inline.pedantic=merge({},inline.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/});inline.gfm=merge({},inline.normal,{escape:replace(inline.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:replace(inline.text)("]|","~]|")("|","|https?://|")()});inline.breaks=merge({},inline.gfm,{br:replace(inline.br)("{2,}","*")(),text:replace(inline.gfm.text)("{2,}","*")()});function InlineLexer(links,options){this.options=options||marked.defaults;this.links=links;this.rules=inline.normal;if(!this.links){throw new Error("Tokens array requires a `links` property.")}if(this.options.gfm){if(this.options.breaks){this.rules=inline.breaks}else{this.rules=inline.gfm}}else if(this.options.pedantic){this.rules=inline.pedantic}}InlineLexer.rules=inline;InlineLexer.output=function(src,links,options){var inline=new InlineLexer(links,options);return inline.output(src)};InlineLexer.prototype.output=function(src){var out="",link,text,href,cap;while(src){if(cap=this.rules.escape.exec(src)){src=src.substring(cap[0].length);out+=cap[1];continue}if(cap=this.rules.autolink.exec(src)){src=src.substring(cap[0].length);if(cap[2]==="@"){text=cap[1].charAt(6)===":"?this.mangle(cap[1].substring(7)):this.mangle(cap[1]);href=this.mangle("mailto:")+text}else{text=escape(cap[1]);href=text}out+='<a href="'+href+'">'+text+"</a>";continue}if(cap=this.rules.url.exec(src)){src=src.substring(cap[0].length);text=escape(cap[1]);href=text;out+='<a href="'+href+'">'+text+"</a>";continue}if(cap=this.rules.tag.exec(src)){src=src.substring(cap[0].length);out+=this.options.sanitize?escape(cap[0]):cap[0];continue}if(cap=this.rules.link.exec(src)){src=src.substring(cap[0].length);out+=this.outputLink(cap,{href:cap[2],title:cap[3]});continue}if((cap=this.rules.reflink.exec(src))||(cap=this.rules.nolink.exec(src))){src=src.substring(cap[0].length);link=(cap[2]||cap[1]).replace(/\s+/g," ");link=this.links[link.toLowerCase()];if(!link||!link.href){out+=cap[0].charAt(0);src=cap[0].substring(1)+src;continue}out+=this.outputLink(cap,link);continue}if(cap=this.rules.strong.exec(src)){src=src.substring(cap[0].length);out+="<strong>"+this.output(cap[2]||cap[1])+"</strong>";continue}if(cap=this.rules.em.exec(src)){src=src.substring(cap[0].length);out+="<em>"+this.output(cap[2]||cap[1])+"</em>";continue}if(cap=this.rules.code.exec(src)){src=src.substring(cap[0].length);out+="<code>"+escape(cap[2],true)+"</code>";continue}if(cap=this.rules.br.exec(src)){src=src.substring(cap[0].length);out+="<br>";continue}if(cap=this.rules.del.exec(src)){src=src.substring(cap[0].length);out+="<del>"+this.output(cap[1])+"</del>";continue}if(cap=this.rules.text.exec(src)){src=src.substring(cap[0].length);out+=escape(this.smartypants(cap[0]));continue}if(src){throw new Error("Infinite loop on byte: "+src.charCodeAt(0))}}return out};InlineLexer.prototype.outputLink=function(cap,link){if(cap[0].charAt(0)!=="!"){return'<a href="'+escape(link.href)+'"'+(link.title?' title="'+escape(link.title)+'"':"")+">"+this.output(cap[1])+"</a>"}else{return'<img src="'+escape(link.href)+'" alt="'+escape(cap[1])+'"'+(link.title?' title="'+escape(link.title)+'"':"")+">"}};InlineLexer.prototype.smartypants=function(text){if(!this.options.smartypants)return text;return text.replace(/--/g,"—").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")};InlineLexer.prototype.mangle=function(text){var out="",l=text.length,i=0,ch;for(;i<l;i++){ch=text.charCodeAt(i);if(Math.random()>.5){ch="x"+ch.toString(16)}out+="&#"+ch+";"}return out};function Parser(options){this.tokens=[];this.token=null;this.options=options||marked.defaults}Parser.parse=function(src,options){var parser=new Parser(options);return parser.parse(src)};Parser.prototype.parse=function(src){this.inline=new InlineLexer(src.links,this.options);this.tokens=src.reverse();var out="";while(this.next()){out+=this.tok()}return out};Parser.prototype.next=function(){return this.token=this.tokens.pop()};Parser.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0};Parser.prototype.parseText=function(){var body=this.token.text;while(this.peek().type==="text"){body+="\n"+this.next().text}return this.inline.output(body)};Parser.prototype.tok=function(){switch(this.token.type){case"space":{return""}case"hr":{return"<hr>\n"}case"heading":{return"<h"+this.token.depth+' id="'+this.token.text.toLowerCase().replace(/[^\w]+/g,"-")+'">'+this.inline.output(this.token.text)+"</h"+this.token.depth+">\n"}case"code":{if(this.options.highlight){var code=this.options.highlight(this.token.text,this.token.lang);if(code!=null&&code!==this.token.text){this.token.escaped=true;this.token.text=code}}if(!this.token.escaped){this.token.text=escape(this.token.text,true)}return"<pre><code"+(this.token.lang?' class="'+this.options.langPrefix+this.token.lang+'"':"")+">"+this.token.text+"</code></pre>\n"}case"table":{var body="",heading,i,row,cell,j;body+="<thead>\n<tr>\n";for(i=0;i<this.token.header.length;i++){heading=this.inline.output(this.token.header[i]);body+="<th";if(this.token.align[i]){body+=' style="text-align:'+this.token.align[i]+'"'}body+=">"+heading+"</th>\n"}body+="</tr>\n</thead>\n";body+="<tbody>\n";for(i=0;i<this.token.cells.length;i++){row=this.token.cells[i];body+="<tr>\n";for(j=0;j<row.length;j++){cell=this.inline.output(row[j]);body+="<td";if(this.token.align[j]){body+=' style="text-align:'+this.token.align[j]+'"'}body+=">"+cell+"</td>\n"}body+="</tr>\n"}body+="</tbody>\n";return"<table>\n"+body+"</table>\n"}case"blockquote_start":{var body="";while(this.next().type!=="blockquote_end"){body+=this.tok()}return"<blockquote>\n"+body+"</blockquote>\n"}case"list_start":{var type=this.token.ordered?"ol":"ul",body="";while(this.next().type!=="list_end"){body+=this.tok()}return"<"+type+">\n"+body+"</"+type+">\n"}case"list_item_start":{var body="";while(this.next().type!=="list_item_end"){body+=this.token.type==="text"?this.parseText():this.tok()}return"<li>"+body+"</li>\n"}case"loose_item_start":{var body="";while(this.next().type!=="list_item_end"){body+=this.tok()}return"<li>"+body+"</li>\n"}case"html":{return!this.token.pre&&!this.options.pedantic?this.inline.output(this.token.text):this.token.text}case"paragraph":{return"<p>"+this.inline.output(this.token.text)+"</p>\n"}case"text":{return"<p>"+this.parseText()+"</p>\n"}}};function escape(html,encode){return html.replace(!encode?/&(?!#?\w+;)/g:/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function replace(regex,opt){regex=regex.source;opt=opt||"";return function self(name,val){if(!name)return new RegExp(regex,opt);val=val.source||val;val=val.replace(/(^|[^\[])\^/g,"$1");regex=regex.replace(name,val);return self}}function noop(){}noop.exec=noop;function merge(obj){var i=1,target,key;for(;i<arguments.length;i++){target=arguments[i];for(key in target){if(Object.prototype.hasOwnProperty.call(target,key)){obj[key]=target[key]}}}return obj}function marked(src,opt,callback){if(callback||typeof opt==="function"){if(!callback){callback=opt;opt=null}opt=merge({},marked.defaults,opt||{});var highlight=opt.highlight,tokens,pending,i=0;try{tokens=Lexer.lex(src,opt)}catch(e){return callback(e)}pending=tokens.length;var done=function(){var out,err;try{out=Parser.parse(tokens,opt)}catch(e){err=e}opt.highlight=highlight;return err?callback(err):callback(null,out)};if(!highlight||highlight.length<3){return done()}delete opt.highlight;if(!pending)return done();for(;i<tokens.length;i++){(function(token){if(token.type!=="code"){return--pending||done()}return highlight(token.text,token.lang,function(err,code){if(code==null||code===token.text){return--pending||done()}token.text=code;token.escaped=true;--pending||done()})})(tokens[i])}return}try{if(opt)opt=merge({},marked.defaults,opt);return Parser.parse(Lexer.lex(src,opt),opt)}catch(e){e.message+="\nPlease report this to https://github.com/chjj/marked.";if((opt||marked.defaults).silent){return"<p>An error occured:</p><pre>"+escape(e.message+"",true)+"</pre>"}throw e}}marked.options=marked.setOptions=function(opt){merge(marked.defaults,opt);return marked};marked.defaults={gfm:true,tables:true,breaks:false,pedantic:false,sanitize:false,smartLists:false,silent:false,highlight:null,langPrefix:"lang-",smartypants:false};marked.Parser=Parser;marked.parser=Parser.parse;marked.Lexer=Lexer;marked.lexer=Lexer.lex;marked.InlineLexer=InlineLexer;marked.inlineLexer=InlineLexer.output;marked.parse=marked;if(typeof exports==="object"){module.exports=marked}else if(typeof define==="function"&&define.amd){define(function(){return marked})}else{this.marked=marked}}).call(function(){return this||(typeof window!=="undefined"?window:global)}())}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],69:[function(_dereq_,module,exports){module.exports={Client:window.WebSocket}},{}],70:[function(_dereq_,module,exports){(typeof define==="function"&&define.amd&&function(m){define("bane",m)}||typeof module==="object"&&function(m){module.exports=m()}||function(m){this.bane=m()})(function(){"use strict";var slice=Array.prototype.slice;function handleError(event,error,errbacks){var i,l=errbacks.length;if(l>0){for(i=0;i<l;++i){errbacks[i](event,error)}return}setTimeout(function(){error.message=event+" listener threw error: "+error.message;throw error},0)}function assertFunction(fn){if(typeof fn!=="function"){throw new TypeError("Listener is not function")}return fn}function supervisors(object){if(!object.supervisors){object.supervisors=[]}return object.supervisors}function listeners(object,event){if(!object.listeners){object.listeners={}}if(event&&!object.listeners[event]){object.listeners[event]=[]}return event?object.listeners[event]:object.listeners}function errbacks(object){if(!object.errbacks){object.errbacks=[]}return object.errbacks}function createEventEmitter(object){object=object||{};function notifyListener(event,listener,args){try{listener.listener.apply(listener.thisp||object,args)}catch(e){handleError(event,e,errbacks(object))}}object.on=function(event,listener,thisp){if(typeof event==="function"){return supervisors(this).push({listener:event,thisp:listener})}listeners(this,event).push({listener:assertFunction(listener),thisp:thisp})};object.off=function(event,listener){var fns,events,i,l;if(!event){fns=supervisors(this);fns.splice(0,fns.length);events=listeners(this);for(i in events){if(events.hasOwnProperty(i)){fns=listeners(this,i);fns.splice(0,fns.length)}}fns=errbacks(this);fns.splice(0,fns.length);return}if(typeof event==="function"){fns=supervisors(this);listener=event}else{fns=listeners(this,event)}if(!listener){fns.splice(0,fns.length);return}for(i=0,l=fns.length;i<l;++i){if(fns[i].listener===listener){fns.splice(i,1);return}}};object.once=function(event,listener,thisp){var wrapper=function(){object.off(event,wrapper);listener.apply(this,arguments)};object.on(event,wrapper,thisp)};object.bind=function(object,events){var prop,i,l;if(!events){for(prop in object){if(typeof object[prop]==="function"){this.on(prop,object[prop],object)}}}else{for(i=0,l=events.length;i<l;++i){if(typeof object[events[i]]==="function"){this.on(events[i],object[events[i]],object)}else{throw new Error("No such method "+events[i])}}}return object};object.emit=function(event){var toNotify=supervisors(this);var args=slice.call(arguments),i,l;for(i=0,l=toNotify.length;i<l;++i){notifyListener(event,toNotify[i],args)}toNotify=listeners(this,event).slice();args=slice.call(arguments,1);for(i=0,l=toNotify.length;i<l;++i){notifyListener(event,toNotify[i],args)}};object.errback=function(listener){if(!this.errbacks){this.errbacks=[]}this.errbacks.push(assertFunction(listener))};return object}return{createEventEmitter:createEventEmitter,aggregate:function(emitters){var aggregate=createEventEmitter();emitters.forEach(function(emitter){emitter.on(function(event,data){aggregate.emit(event,data)})});return aggregate}}})},{}],71:[function(_dereq_,module,exports){(function(define){"use strict";define(function(_dereq_){var makePromise=_dereq_("./makePromise");var Scheduler=_dereq_("./scheduler");var async=_dereq_("./async");return makePromise({scheduler:new Scheduler(async)})})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory(_dereq_)})},{"./async":74,"./makePromise":84,"./scheduler":85}],72:[function(_dereq_,module,exports){(function(define){"use strict";define(function(){function Queue(capacityPow2){this.head=this.tail=this.length=0;this.buffer=new Array(1<<capacityPow2)}Queue.prototype.push=function(x){if(this.length===this.buffer.length){this._ensureCapacity(this.length*2)}this.buffer[this.tail]=x;this.tail=this.tail+1&this.buffer.length-1;++this.length;return this.length};Queue.prototype.shift=function(){var x=this.buffer[this.head];this.buffer[this.head]=void 0;this.head=this.head+1&this.buffer.length-1;--this.length;return x};Queue.prototype._ensureCapacity=function(capacity){var head=this.head;var buffer=this.buffer;var newBuffer=new Array(capacity);var i=0;var len;if(head===0){len=this.length;for(;i<len;++i){newBuffer[i]=buffer[i]}}else{capacity=buffer.length;len=this.tail;for(;head<capacity;++i,++head){newBuffer[i]=buffer[head]}for(head=0;head<len;++i,++head){newBuffer[i]=buffer[head]}}this.buffer=newBuffer;this.head=0;this.tail=this.length};return Queue})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory()})},{}],73:[function(_dereq_,module,exports){(function(define){"use strict";define(function(){function TimeoutError(message){Error.call(this);this.message=message;this.name=TimeoutError.name;if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,TimeoutError)}}TimeoutError.prototype=Object.create(Error.prototype);TimeoutError.prototype.constructor=TimeoutError;return TimeoutError})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory()})},{}],74:[function(_dereq_,module,exports){(function(process){(function(define){"use strict";define(function(_dereq_){var nextTick,MutationObs;if(typeof process!=="undefined"&&process!==null&&typeof process.nextTick==="function"){nextTick=function(f){process.nextTick(f)}}else if(MutationObs=typeof MutationObserver==="function"&&MutationObserver||typeof WebKitMutationObserver==="function"&&WebKitMutationObserver){nextTick=function(document,MutationObserver){var scheduled;var el=document.createElement("div");var o=new MutationObserver(run);o.observe(el,{attributes:true});function run(){var f=scheduled;
scheduled=void 0;f()}return function(f){scheduled=f;el.setAttribute("class","x")}}(document,MutationObs)}else{nextTick=function(cjsRequire){try{return cjsRequire("vertx").runOnLoop||cjsRequire("vertx").runOnContext}catch(ignore){}var capturedSetTimeout=setTimeout;return function(t){capturedSetTimeout(t,0)}}(_dereq_)}return nextTick})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory(_dereq_)})}).call(this,_dereq_("FWaASH"))},{FWaASH:60}],75:[function(_dereq_,module,exports){(function(define){"use strict";define(function(){return function array(Promise){var arrayMap=Array.prototype.map;var arrayReduce=Array.prototype.reduce;var arrayReduceRight=Array.prototype.reduceRight;var arrayForEach=Array.prototype.forEach;var toPromise=Promise.resolve;var all=Promise.all;Promise.any=any;Promise.some=some;Promise.settle=settle;Promise.map=map;Promise.reduce=reduce;Promise.reduceRight=reduceRight;Promise.prototype.spread=function(onFulfilled){return this.then(all).then(function(array){return onFulfilled.apply(void 0,array)})};return Promise;function any(promises){return new Promise(function(resolve,reject){var pending=0;var errors=[];arrayForEach.call(promises,function(p){++pending;toPromise(p).then(resolve,handleReject)});if(pending===0){resolve()}function handleReject(e){errors.push(e);if(--pending===0){reject(errors)}}})}function some(promises,n){return new Promise(function(resolve,reject,notify){var nFulfill=0;var nReject;var results=[];var errors=[];arrayForEach.call(promises,function(p){++nFulfill;toPromise(p).then(handleResolve,handleReject,notify)});n=Math.max(n,0);nReject=nFulfill-n+1;nFulfill=Math.min(n,nFulfill);if(nFulfill===0){resolve(results);return}function handleResolve(x){if(nFulfill>0){--nFulfill;results.push(x);if(nFulfill===0){resolve(results)}}}function handleReject(e){if(nReject>0){--nReject;errors.push(e);if(nReject===0){reject(errors)}}}})}function map(promises,f,fallback){return all(arrayMap.call(promises,function(x){return toPromise(x).then(f,fallback)}))}function settle(promises){return all(arrayMap.call(promises,function(p){p=toPromise(p);return p.then(inspect,inspect);function inspect(){return p.inspect()}}))}function reduce(promises,f){return arguments.length>2?arrayReduce.call(promises,reducer,arguments[2]):arrayReduce.call(promises,reducer);function reducer(result,x,i){return toPromise(result).then(function(r){return toPromise(x).then(function(x){return f(r,x,i)})})}}function reduceRight(promises,f){return arguments.length>2?arrayReduceRight.call(promises,reducer,arguments[2]):arrayReduceRight.call(promises,reducer);function reducer(result,x,i){return toPromise(result).then(function(r){return toPromise(x).then(function(x){return f(r,x,i)})})}}}})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory()})},{}],76:[function(_dereq_,module,exports){(function(define){"use strict";define(function(){return function flow(Promise){var reject=Promise.reject;var origCatch=Promise.prototype["catch"];Promise.prototype.done=function(onResult,onError){var h=this._handler;h.when({resolve:this._maybeFatal,notify:noop,context:this,receiver:h.receiver,fulfilled:onResult,rejected:onError,progress:void 0})};Promise.prototype["catch"]=Promise.prototype.otherwise=function(onRejected){if(arguments.length===1){return origCatch.call(this,onRejected)}else{if(typeof onRejected!=="function"){return this.ensure(rejectInvalidPredicate)}return origCatch.call(this,createCatchFilter(arguments[1],onRejected))}};function createCatchFilter(handler,predicate){return function(e){return evaluatePredicate(e,predicate)?handler.call(this,e):reject(e)}}Promise.prototype["finally"]=Promise.prototype.ensure=function(handler){if(typeof handler!=="function"){return this}handler=isolate(handler,this);return this.then(handler,handler)};Promise.prototype["else"]=Promise.prototype.orElse=function(defaultValue){return this.then(void 0,function(){return defaultValue})};Promise.prototype["yield"]=function(value){return this.then(function(){return value})};Promise.prototype.tap=function(onFulfilledSideEffect){return this.then(onFulfilledSideEffect)["yield"](this)};return Promise};function rejectInvalidPredicate(){throw new TypeError("catch predicate must be a function")}function evaluatePredicate(e,predicate){return isError(predicate)?e instanceof predicate:predicate(e)}function isError(predicate){return predicate===Error||predicate!=null&&predicate.prototype instanceof Error}function isolate(f,x){return function(){f.call(this);return x}}function noop(){}})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory()})},{}],77:[function(_dereq_,module,exports){(function(define){"use strict";define(function(){return function fold(Promise){Promise.prototype.fold=function(fn,arg){var promise=this._beget();this._handler.fold(promise._handler,fn,arg);return promise};return Promise}})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory()})},{}],78:[function(_dereq_,module,exports){(function(define){"use strict";define(function(){return function inspect(Promise){Promise.prototype.inspect=function(){return this._handler.inspect()};return Promise}})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory()})},{}],79:[function(_dereq_,module,exports){(function(define){"use strict";define(function(){return function generate(Promise){var resolve=Promise.resolve;Promise.iterate=iterate;Promise.unfold=unfold;return Promise;function iterate(f,condition,handler,x){return unfold(function(x){return[x,f(x)]},condition,handler,x)}function unfold(unspool,condition,handler,x){return resolve(x).then(function(seed){return resolve(condition(seed)).then(function(done){return done?seed:resolve(unspool(seed)).spread(next)})});function next(item,newSeed){return resolve(handler(item)).then(function(){return unfold(unspool,condition,handler,newSeed)})}}}})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory()})},{}],80:[function(_dereq_,module,exports){(function(define){"use strict";define(function(){return function progress(Promise){Promise.prototype.progress=function(onProgress){return this.then(void 0,void 0,onProgress)};return Promise}})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory()})},{}],81:[function(_dereq_,module,exports){(function(define){"use strict";define(function(_dereq_){var timer=_dereq_("../timer");var TimeoutError=_dereq_("../TimeoutError");return function timed(Promise){Promise.prototype.delay=function(ms){var p=this._beget();var h=p._handler;this._handler.map(function delay(x){timer.set(function(){h.resolve(x)},ms)},h);return p};Promise.prototype.timeout=function(ms,reason){var hasReason=arguments.length>1;var p=this._beget();var h=p._handler;var t=timer.set(onTimeout,ms);this._handler.chain(h,function onFulfill(x){timer.clear(t);this.resolve(x)},function onReject(x){timer.clear(t);this.reject(x)},h.notify);return p;function onTimeout(){h.reject(hasReason?reason:new TimeoutError("timed out after "+ms+"ms"))}};return Promise}})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory(_dereq_)})},{"../TimeoutError":73,"../timer":86}],82:[function(_dereq_,module,exports){(function(define){"use strict";define(function(_dereq_){var timer=_dereq_("../timer");return function unhandledRejection(Promise){var logError=noop;var logInfo=noop;if(typeof console!=="undefined"){logError=typeof console.error!=="undefined"?function(e){console.error(e)}:function(e){console.log(e)};logInfo=typeof console.info!=="undefined"?function(e){console.info(e)}:function(e){console.log(e)}}Promise.onPotentiallyUnhandledRejection=function(rejection){enqueue(report,rejection)};Promise.onPotentiallyUnhandledRejectionHandled=function(rejection){enqueue(unreport,rejection)};Promise.onFatalRejection=function(rejection){enqueue(throwit,rejection.value)};var tasks=[];var reported=[];var running=false;function report(r){if(!r.handled){reported.push(r);logError("Potentially unhandled rejection ["+r.id+"] "+formatError(r.value))}}function unreport(r){var i=reported.indexOf(r);if(i>=0){reported.splice(i,1);logInfo("Handled previous rejection ["+r.id+"] "+formatObject(r.value))}}function enqueue(f,x){tasks.push(f,x);if(!running){running=true;running=timer.set(flush,0)}}function flush(){running=false;while(tasks.length>0){tasks.shift()(tasks.shift())}}return Promise};function formatError(e){var s=typeof e==="object"&&e.stack?e.stack:formatObject(e);return e instanceof Error?s:s+" (WARNING: non-Error used)"}function formatObject(o){var s=String(o);if(s==="[object Object]"&&typeof JSON!=="undefined"){s=tryStringify(o,s)}return s}function tryStringify(e,defaultValue){try{return JSON.stringify(e)}catch(e){return defaultValue}}function throwit(e){throw e}function noop(){}})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory(_dereq_)})},{"../timer":86}],83:[function(_dereq_,module,exports){(function(define){"use strict";define(function(){return function addWith(Promise){Promise.prototype["with"]=Promise.prototype.withThis=Promise.prototype._bindContext;return Promise}})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory()})},{}],84:[function(_dereq_,module,exports){(function(define){"use strict";define(function(){return function makePromise(environment){var tasks=environment.scheduler;var objectCreate=Object.create||function(proto){function Child(){}Child.prototype=proto;return new Child};function Promise(resolver,handler){this._handler=resolver===Handler?handler:init(resolver)}function init(resolver){var handler=new DeferredHandler;try{resolver(promiseResolve,promiseReject,promiseNotify)}catch(e){promiseReject(e)}return handler;function promiseResolve(x){handler.resolve(x)}function promiseReject(reason){handler.reject(reason)}function promiseNotify(x){handler.notify(x)}}Promise.resolve=resolve;Promise.reject=reject;Promise.never=never;Promise._defer=defer;function resolve(x){return isPromise(x)?x:new Promise(Handler,new AsyncHandler(getHandler(x)))}function reject(x){return new Promise(Handler,new AsyncHandler(new RejectedHandler(x)))}function never(){return foreverPendingPromise}function defer(){return new Promise(Handler,new DeferredHandler)}Promise.prototype.then=function(onFulfilled,onRejected){var parent=this._handler;if(typeof onFulfilled!=="function"&&parent.join().state()>0){return new Promise(Handler,parent)}var p=this._beget();var child=p._handler;parent.when({resolve:child.resolve,notify:child.notify,context:child,receiver:parent.receiver,fulfilled:onFulfilled,rejected:onRejected,progress:arguments.length>2?arguments[2]:void 0});return p};Promise.prototype["catch"]=function(onRejected){return this.then(void 0,onRejected)};Promise.prototype._bindContext=function(thisArg){return new Promise(Handler,new BoundHandler(this._handler,thisArg))};Promise.prototype._beget=function(){var parent=this._handler;var child=new DeferredHandler(parent.receiver,parent.join().context);return new this.constructor(Handler,child)};Promise.prototype._maybeFatal=function(x){if(!maybeThenable(x)){return}var handler=getHandler(x);var context=this._handler.context;handler.catchError(function(){this._fatal(context)},handler)};Promise.all=all;Promise.race=race;function all(promises){var resolver=new DeferredHandler;var pending=promises.length>>>0;var results=new Array(pending);var i,h,x,s;for(i=0;i<promises.length;++i){x=promises[i];if(x===void 0&&!(i in promises)){--pending;continue}if(maybeThenable(x)){h=isPromise(x)?x._handler.join():getHandlerUntrusted(x);s=h.state();if(s===0){resolveOne(resolver,results,h,i)}else if(s>0){results[i]=h.value;--pending}else{resolver.become(h);break}}else{results[i]=x;--pending}}if(pending===0){resolver.become(new FulfilledHandler(results))}return new Promise(Handler,resolver);function resolveOne(resolver,results,handler,i){handler.map(function(x){results[i]=x;if(--pending===0){this.become(new FulfilledHandler(results))}},resolver)}}function race(promises){if(Object(promises)===promises&&promises.length===0){return never()}var h=new DeferredHandler;var i,x;for(i=0;i<promises.length;++i){x=promises[i];if(x!==void 0&&i in promises){getHandler(x).chain(h,h.resolve,h.reject)}}return new Promise(Handler,h)}function getHandler(x){if(isPromise(x)){return x._handler.join()}return maybeThenable(x)?getHandlerUntrusted(x):new FulfilledHandler(x)}function isPromise(x){return x instanceof Promise}function getHandlerUntrusted(x){try{var untrustedThen=x.then;return typeof untrustedThen==="function"?new ThenableHandler(untrustedThen,x):new FulfilledHandler(x)}catch(e){return new RejectedHandler(e)}}function Handler(){}Handler.prototype.when=Handler.prototype.resolve=Handler.prototype.reject=Handler.prototype.notify=Handler.prototype._fatal=Handler.prototype._unreport=Handler.prototype._report=noop;Handler.prototype.inspect=toPendingState;Handler.prototype._state=0;Handler.prototype.state=function(){return this._state};Handler.prototype.join=function(){var h=this;while(h.handler!==void 0){h=h.handler}return h};Handler.prototype.chain=function(to,fulfilled,rejected,progress){this.when({resolve:noop,notify:noop,context:void 0,receiver:to,fulfilled:fulfilled,rejected:rejected,progress:progress})};Handler.prototype.map=function(f,to){this.chain(to,f,to.reject,to.notify)};Handler.prototype.catchError=function(f,to){this.chain(to,to.resolve,f,to.notify)};Handler.prototype.fold=function(to,f,z){this.join().map(function(x){getHandler(z).map(function(z){this.resolve(tryCatchReject2(f,z,x,this.receiver))},this)},to)};function DeferredHandler(receiver,inheritedContext){Promise.createContext(this,inheritedContext);this.consumers=void 0;this.receiver=receiver;this.handler=void 0;this.resolved=false}inherit(Handler,DeferredHandler);DeferredHandler.prototype._state=0;DeferredHandler.prototype.inspect=function(){return this.resolved?this.join().inspect():toPendingState()};DeferredHandler.prototype.resolve=function(x){if(!this.resolved){this.become(getHandler(x))}};DeferredHandler.prototype.reject=function(x){if(!this.resolved){this.become(new RejectedHandler(x))}};DeferredHandler.prototype.join=function(){if(this.resolved){var h=this;while(h.handler!==void 0){h=h.handler;if(h===this){return this.handler=new Cycle}}return h}else{return this}};DeferredHandler.prototype.run=function(){var q=this.consumers;var handler=this.join();this.consumers=void 0;for(var i=0;i<q.length;++i){handler.when(q[i])}};DeferredHandler.prototype.become=function(handler){this.resolved=true;this.handler=handler;if(this.consumers!==void 0){tasks.enqueue(this)}if(this.context!==void 0){handler._report(this.context)}};DeferredHandler.prototype.when=function(continuation){if(this.resolved){tasks.enqueue(new ContinuationTask(continuation,this.handler))}else{if(this.consumers===void 0){this.consumers=[continuation]}else{this.consumers.push(continuation)}}};DeferredHandler.prototype.notify=function(x){if(!this.resolved){tasks.enqueue(new ProgressTask(this,x))}};DeferredHandler.prototype._report=function(context){this.resolved&&this.handler.join()._report(context)};DeferredHandler.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()};DeferredHandler.prototype._fatal=function(context){var c=typeof context==="undefined"?this.context:context;this.resolved&&this.handler.join()._fatal(c)};function DelegateHandler(handler){this.handler=handler}inherit(Handler,DelegateHandler);DelegateHandler.prototype.inspect=function(){return this.join().inspect()};DelegateHandler.prototype._report=function(context){this.join()._report(context)};DelegateHandler.prototype._unreport=function(){this.join()._unreport()};function AsyncHandler(handler){DelegateHandler.call(this,handler)}inherit(DelegateHandler,AsyncHandler);AsyncHandler.prototype.when=function(continuation){tasks.enqueue(new ContinuationTask(continuation,this.join()))};function BoundHandler(handler,receiver){DelegateHandler.call(this,handler);this.receiver=receiver}inherit(DelegateHandler,BoundHandler);BoundHandler.prototype.when=function(continuation){if(this.receiver!==void 0){continuation.receiver=this.receiver}this.join().when(continuation)};function ThenableHandler(then,thenable){DeferredHandler.call(this);tasks.enqueue(new AssimilateTask(then,thenable,this))}inherit(DeferredHandler,ThenableHandler);function FulfilledHandler(x){Promise.createContext(this);this.value=x}inherit(Handler,FulfilledHandler);FulfilledHandler.prototype._state=1;FulfilledHandler.prototype.inspect=function(){return{state:"fulfilled",value:this.value}};FulfilledHandler.prototype.when=function(cont){var x;if(typeof cont.fulfilled==="function"){Promise.enterContext(this);x=tryCatchReject(cont.fulfilled,this.value,cont.receiver);Promise.exitContext()}else{x=this.value}cont.resolve.call(cont.context,x)};var id=0;function RejectedHandler(x){Promise.createContext(this);this.id=++id;this.value=x;this.handled=false;this.reported=false;this._report()}inherit(Handler,RejectedHandler);RejectedHandler.prototype._state=-1;RejectedHandler.prototype.inspect=function(){return{state:"rejected",reason:this.value}};RejectedHandler.prototype.when=function(cont){var x;if(typeof cont.rejected==="function"){this._unreport();Promise.enterContext(this);x=tryCatchReject(cont.rejected,this.value,cont.receiver);Promise.exitContext()}else{x=new Promise(Handler,this)}cont.resolve.call(cont.context,x)};RejectedHandler.prototype._report=function(context){tasks.afterQueue(reportUnhandled,this,context)};RejectedHandler.prototype._unreport=function(){this.handled=true;tasks.afterQueue(reportHandled,this)};RejectedHandler.prototype._fatal=function(context){Promise.onFatalRejection(this,context)};function reportUnhandled(rejection,context){if(!rejection.handled){rejection.reported=true;Promise.onPotentiallyUnhandledRejection(rejection,context)}}function reportHandled(rejection){if(rejection.reported){Promise.onPotentiallyUnhandledRejectionHandled(rejection)}}Promise.createContext=Promise.enterContext=Promise.exitContext=Promise.onPotentiallyUnhandledRejection=Promise.onPotentiallyUnhandledRejectionHandled=Promise.onFatalRejection=noop;var foreverPendingHandler=new Handler;var foreverPendingPromise=new Promise(Handler,foreverPendingHandler);function Cycle(){RejectedHandler.call(this,new TypeError("Promise cycle"))}inherit(RejectedHandler,Cycle);function toPendingState(){return{state:"pending"}}function ContinuationTask(continuation,handler){this.continuation=continuation;this.handler=handler}ContinuationTask.prototype.run=function(){this.handler.join().when(this.continuation)};function ProgressTask(handler,value){this.handler=handler;this.value=value}ProgressTask.prototype.run=function(){var q=this.handler.consumers;if(q===void 0){return}for(var i=0;i<q.length;++i){this._notify(q[i])}};ProgressTask.prototype._notify=function(continuation){var x=typeof continuation.progress==="function"?tryCatchReturn(continuation.progress,this.value,continuation.receiver):this.value;continuation.notify.call(continuation.context,x)};function AssimilateTask(then,thenable,resolver){this._then=then;this.thenable=thenable;this.resolver=resolver}AssimilateTask.prototype.run=function(){var h=this.resolver;tryAssimilate(this._then,this.thenable,_resolve,_reject,_notify);function _resolve(x){h.resolve(x)}function _reject(x){h.reject(x)}function _notify(x){h.notify(x)}};function tryAssimilate(then,thenable,resolve,reject,notify){try{then.call(thenable,resolve,reject,notify)}catch(e){reject(e)}}function maybeThenable(x){return(typeof x==="object"||typeof x==="function")&&x!==null}function tryCatchReject(f,x,thisArg){try{return f.call(thisArg,x)}catch(e){return reject(e)}}function tryCatchReject2(f,x,y,thisArg){try{return f.call(thisArg,x,y)}catch(e){return reject(e)}}function tryCatchReturn(f,x,thisArg){try{return f.call(thisArg,x)}catch(e){return e}}function inherit(Parent,Child){Child.prototype=objectCreate(Parent.prototype);Child.prototype.constructor=Child}function noop(){}return Promise}})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory()})},{}],85:[function(_dereq_,module,exports){(function(define){"use strict";define(function(_dereq_){var Queue=_dereq_("./Queue");function Scheduler(enqueue){this._enqueue=enqueue;this._handlerQueue=new Queue(15);this._afterQueue=new Queue(5);this._running=false;var self=this;this.drain=function(){self._drain()}}Scheduler.prototype.enqueue=function(task){this._handlerQueue.push(task);if(!this._running){this._running=true;this._enqueue(this.drain)}};Scheduler.prototype.afterQueue=function(f,x,y){this._afterQueue.push(f);this._afterQueue.push(x);this._afterQueue.push(y);if(!this._running){this._running=true;this._enqueue(this.drain)}};Scheduler.prototype._drain=function(){var q=this._handlerQueue;while(q.length>0){q.shift().run()}this._running=false;q=this._afterQueue;while(q.length>0){q.shift()(q.shift(),q.shift())}};return Scheduler})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory(_dereq_)})},{"./Queue":72}],86:[function(_dereq_,module,exports){(function(define){"use strict";define(function(_dereq_){var cjsRequire,vertx,setTimer,clearTimer;cjsRequire=_dereq_;try{vertx=cjsRequire("vertx");setTimer=function(f,ms){return vertx.setTimer(ms,f)};clearTimer=vertx.cancelTimer}catch(e){setTimer=function(f,ms){return setTimeout(f,ms)};clearTimer=function(t){return clearTimeout(t)}}return{set:setTimer,clear:clearTimer}})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory(_dereq_)})},{}],87:[function(_dereq_,module,exports){(function(define){"use strict";define(function(_dereq_){var timed=_dereq_("./lib/decorators/timed");var array=_dereq_("./lib/decorators/array");var flow=_dereq_("./lib/decorators/flow");var fold=_dereq_("./lib/decorators/fold");var inspect=_dereq_("./lib/decorators/inspect");var generate=_dereq_("./lib/decorators/iterate");var progress=_dereq_("./lib/decorators/progress");var withThis=_dereq_("./lib/decorators/with");var unhandledRejection=_dereq_("./lib/decorators/unhandledRejection");var TimeoutError=_dereq_("./lib/TimeoutError");var Promise=[array,flow,fold,generate,progress,inspect,withThis,timed,unhandledRejection].reduce(function(Promise,feature){return feature(Promise)},_dereq_("./lib/Promise"));var slice=Array.prototype.slice;when.promise=promise;when.resolve=Promise.resolve;when.reject=Promise.reject;when.lift=lift;when["try"]=attempt;when.attempt=attempt;when.iterate=Promise.iterate;when.unfold=Promise.unfold;when.join=join;when.all=all;when.settle=settle;when.any=lift(Promise.any);when.some=lift(Promise.some);when.map=map;when.reduce=reduce;when.reduceRight=reduceRight;when.isPromiseLike=isPromiseLike;when.Promise=Promise;when.defer=defer;when.TimeoutError=TimeoutError;function when(x,onFulfilled,onRejected){var p=Promise.resolve(x);if(arguments.length<2){return p}return arguments.length>3?p.then(onFulfilled,onRejected,arguments[3]):p.then(onFulfilled,onRejected)}function promise(resolver){return new Promise(resolver)}function lift(f){return function(){return _apply(f,this,slice.call(arguments))}}function attempt(f){return _apply(f,this,slice.call(arguments,1))}function _apply(f,thisArg,args){return Promise.all(args).then(function(args){return f.apply(thisArg,args)})}function defer(){return new Deferred}function Deferred(){var p=Promise._defer();function resolve(x){p._handler.resolve(x)}function reject(x){p._handler.reject(x)}function notify(x){p._handler.notify(x)}this.promise=p;this.resolve=resolve;this.reject=reject;this.notify=notify;this.resolver={resolve:resolve,reject:reject,notify:notify}}function isPromiseLike(x){return x&&typeof x.then==="function"}function join(){return Promise.all(arguments)}function all(promises){return when(promises,Promise.all)}function settle(promises){return when(promises,Promise.settle)}function map(promises,mapFunc){return when(promises,function(promises){return Promise.map(promises,mapFunc)})}function reduce(promises,f){var args=slice.call(arguments,1);return when(promises,function(array){args.unshift(array);return Promise.reduce.apply(Promise,args)})}function reduceRight(promises,f){var args=slice.call(arguments,1);return when(promises,function(array){args.unshift(array);return Promise.reduceRight.apply(Promise,args)})}return when})})(typeof define==="function"&&define.amd?define:function(factory){module.exports=factory(_dereq_)})},{"./lib/Promise":71,"./lib/TimeoutError":73,"./lib/decorators/array":75,"./lib/decorators/flow":76,"./lib/decorators/fold":77,"./lib/decorators/inspect":78,"./lib/decorators/iterate":79,"./lib/decorators/progress":80,"./lib/decorators/timed":81,"./lib/decorators/unhandledRejection":82,"./lib/decorators/with":83}],88:[function(_dereq_,module,exports){var bane=_dereq_("bane");var websocket=_dereq_("../lib/websocket/");var when=_dereq_("when");function Mopidy(settings){if(!(this instanceof Mopidy)){return new Mopidy(settings)}this._console=this._getConsole(settings||{});this._settings=this._configure(settings||{});this._backoffDelay=this._settings.backoffDelayMin;this._pendingRequests={};this._webSocket=null;bane.createEventEmitter(this);this._delegateEvents();if(this._settings.autoConnect){this.connect()}}Mopidy.ConnectionError=function(message){this.name="ConnectionError";this.message=message};Mopidy.ConnectionError.prototype=new Error;Mopidy.ConnectionError.prototype.constructor=Mopidy.ConnectionError;Mopidy.ServerError=function(message){this.name="ServerError";this.message=message};Mopidy.ServerError.prototype=new Error;Mopidy.ServerError.prototype.constructor=Mopidy.ServerError;Mopidy.WebSocket=websocket.Client;Mopidy.prototype._getConsole=function(settings){if(typeof settings.console!=="undefined"){return settings.console}var con=typeof console!=="undefined"&&console||{};con.log=con.log||function(){};con.warn=con.warn||function(){};con.error=con.error||function(){};return con};Mopidy.prototype._configure=function(settings){var currentHost=typeof document!=="undefined"&&document.location.host||"localhost";settings.webSocketUrl=settings.webSocketUrl||"ws://"+currentHost+"/mopidy/ws";if(settings.autoConnect!==false){settings.autoConnect=true}settings.backoffDelayMin=settings.backoffDelayMin||1e3;settings.backoffDelayMax=settings.backoffDelayMax||64e3;if(typeof settings.callingConvention==="undefined"){this._console.warn("Mopidy.js is using the default calling convention. The "+"default will change in the future. You should explicitly "+"specify which calling convention you use.")}settings.callingConvention=settings.callingConvention||"by-position-only";return settings};Mopidy.prototype._delegateEvents=function(){this.off("websocket:close");this.off("websocket:error");this.off("websocket:incomingMessage");this.off("websocket:open");this.off("state:offline");this.on("websocket:close",this._cleanup);this.on("websocket:error",this._handleWebSocketError);this.on("websocket:incomingMessage",this._handleMessage);this.on("websocket:open",this._resetBackoffDelay);this.on("websocket:open",this._getApiSpec);this.on("state:offline",this._reconnect)};Mopidy.prototype.connect=function(){if(this._webSocket){if(this._webSocket.readyState===Mopidy.WebSocket.OPEN){return}else{this._webSocket.close()}}this._webSocket=this._settings.webSocket||new Mopidy.WebSocket(this._settings.webSocketUrl);this._webSocket.onclose=function(close){this.emit("websocket:close",close)}.bind(this);this._webSocket.onerror=function(error){this.emit("websocket:error",error)}.bind(this);this._webSocket.onopen=function(){this.emit("websocket:open")}.bind(this);this._webSocket.onmessage=function(message){this.emit("websocket:incomingMessage",message)}.bind(this)};Mopidy.prototype._cleanup=function(closeEvent){Object.keys(this._pendingRequests).forEach(function(requestId){var resolver=this._pendingRequests[requestId];delete this._pendingRequests[requestId];var error=new Mopidy.ConnectionError("WebSocket closed");error.closeEvent=closeEvent;resolver.reject(error)}.bind(this));this.emit("state:offline")};Mopidy.prototype._reconnect=function(){this.emit("reconnectionPending",{timeToAttempt:this._backoffDelay});setTimeout(function(){this.emit("reconnecting");this.connect()}.bind(this),this._backoffDelay);this._backoffDelay=this._backoffDelay*2;if(this._backoffDelay>this._settings.backoffDelayMax){this._backoffDelay=this._settings.backoffDelayMax}};Mopidy.prototype._resetBackoffDelay=function(){this._backoffDelay=this._settings.backoffDelayMin};Mopidy.prototype.close=function(){this.off("state:offline",this._reconnect);this._webSocket.close()};Mopidy.prototype._handleWebSocketError=function(error){this._console.warn("WebSocket error:",error.stack||error)};Mopidy.prototype._send=function(message){switch(this._webSocket.readyState){case Mopidy.WebSocket.CONNECTING:return when.reject(new Mopidy.ConnectionError("WebSocket is still connecting"));case Mopidy.WebSocket.CLOSING:return when.reject(new Mopidy.ConnectionError("WebSocket is closing"));case Mopidy.WebSocket.CLOSED:return when.reject(new Mopidy.ConnectionError("WebSocket is closed"));default:var deferred=when.defer();message.jsonrpc="2.0";message.id=this._nextRequestId();this._pendingRequests[message.id]=deferred.resolver;this._webSocket.send(JSON.stringify(message));this.emit("websocket:outgoingMessage",message);return deferred.promise}};Mopidy.prototype._nextRequestId=function(){var lastUsed=-1;return function(){lastUsed+=1;return lastUsed}}();Mopidy.prototype._handleMessage=function(message){try{var data=JSON.parse(message.data);if(data.hasOwnProperty("id")){this._handleResponse(data)}else if(data.hasOwnProperty("event")){this._handleEvent(data)}else{this._console.warn("Unknown message type received. Message was: "+message.data)}}catch(error){if(error instanceof SyntaxError){this._console.warn("WebSocket message parsing failed. Message was: "+message.data)}else{throw error}}};Mopidy.prototype._handleResponse=function(responseMessage){if(!this._pendingRequests.hasOwnProperty(responseMessage.id)){this._console.warn("Unexpected response received. Message was:",responseMessage);return}var error;var resolver=this._pendingRequests[responseMessage.id];delete this._pendingRequests[responseMessage.id];if(responseMessage.hasOwnProperty("result")){resolver.resolve(responseMessage.result)}else if(responseMessage.hasOwnProperty("error")){error=new Mopidy.ServerError(responseMessage.error.message);error.code=responseMessage.error.code;error.data=responseMessage.error.data;resolver.reject(error);this._console.warn("Server returned error:",responseMessage.error)}else{error=new Error("Response without 'result' or 'error' received");error.data={response:responseMessage};resolver.reject(error);this._console.warn("Response without 'result' or 'error' received. Message was:",responseMessage)}};Mopidy.prototype._handleEvent=function(eventMessage){var type=eventMessage.event;var data=eventMessage;delete data.event;this.emit("event:"+this._snakeToCamel(type),data)};Mopidy.prototype._getApiSpec=function(){return this._send({method:"core.describe"}).then(this._createApi.bind(this)).catch(this._handleWebSocketError)};Mopidy.prototype._createApi=function(methods){var byPositionOrByName=this._settings.callingConvention==="by-position-or-by-name";var caller=function(method){return function(){var message={method:method};if(arguments.length===0){return this._send(message)}if(!byPositionOrByName){message.params=Array.prototype.slice.call(arguments);return this._send(message)}if(arguments.length>1){return when.reject(new Error("Expected zero arguments, a single array, "+"or a single object."))}if(!Array.isArray(arguments[0])&&arguments[0]!==Object(arguments[0])){return when.reject(new TypeError("Expected an array or an object."))}message.params=arguments[0];return this._send(message)
}.bind(this)}.bind(this);var getPath=function(fullName){var path=fullName.split(".");if(path.length>=1&&path[0]==="core"){path=path.slice(1)}return path};var createObjects=function(objPath){var parentObj=this;objPath.forEach(function(objName){objName=this._snakeToCamel(objName);parentObj[objName]=parentObj[objName]||{};parentObj=parentObj[objName]}.bind(this));return parentObj}.bind(this);var createMethod=function(fullMethodName){var methodPath=getPath(fullMethodName);var methodName=this._snakeToCamel(methodPath.slice(-1)[0]);var object=createObjects(methodPath.slice(0,-1));object[methodName]=caller(fullMethodName);object[methodName].description=methods[fullMethodName].description;object[methodName].params=methods[fullMethodName].params}.bind(this);Object.keys(methods).forEach(createMethod);this.emit("state:online")};Mopidy.prototype._snakeToCamel=function(name){return name.replace(/(_[a-z])/g,function(match){return match.toUpperCase().replace("_","")})};module.exports=Mopidy},{"../lib/websocket/":69,bane:70,when:87}],89:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,self=this;function program1(depth0,data){return'\n<li class="track_list_item empty-list">No Albums</li>\n'}stack1=helpers.unless.call(depth0,depth0&&depth0.collection,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+="\n";return buffer})},{"handlebars/runtime":67}],90:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,helper,functionType="function",escapeExpression=this.escapeExpression;buffer+='<span class="album_title">';if(helper=helpers.name){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.name;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}buffer+=escapeExpression(stack1)+'</span> <span class="album_artist">'+escapeExpression((stack1=(stack1=(stack1=depth0&&depth0.artists,stack1==null||stack1===false?stack1:stack1[0]),stack1==null||stack1===false?stack1:stack1.name),typeof stack1===functionType?stack1.apply(depth0):stack1))+"</span>\n";return buffer})},{"handlebars/runtime":67}],91:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,functionType="function",escapeExpression=this.escapeExpression;buffer+='<img src="'+escapeExpression((stack1=(stack1=(stack1=depth0&&depth0.image,stack1==null||stack1===false?stack1:stack1[2]),stack1==null||stack1===false?stack1:stack1["#text"]),typeof stack1===functionType?stack1.apply(depth0):stack1))+'">\n';return buffer})},{"handlebars/runtime":67}],92:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};return'<div class="columns one-half">\n<section class="view-section album_tracks">\n<h1>Tracks</h1>\n<ul class="action-toolbar">\n  <li><span role="button" class="queue_all" tabindex="0">Queue Album</span> <span role="button" class="queue_selected" tabindex="0">Queue Selected</span></li>\n</ul>\n</section>\n</div>\n\n<div class="columns one-half">\n<section class="view-section album_description">\n</section>\n</div>\n'})},{"handlebars/runtime":67}],93:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,self=this;function program1(depth0,data){return'\n<li class="interactive-list-item empty-list">No Artists</li>\n'}stack1=helpers.unless.call(depth0,depth0&&depth0.collection,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+="\n";return buffer})},{"handlebars/runtime":67}],94:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,helper,functionType="function",escapeExpression=this.escapeExpression;buffer+='<span class="artist_title">';if(helper=helpers.name){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.name;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}buffer+=escapeExpression(stack1)+"</span>\n";return buffer})},{"handlebars/runtime":67}],95:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,helper,functionType="function",escapeExpression=this.escapeExpression;buffer+='<a href="#artists/';if(helper=helpers.uri){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.uri;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}buffer+=escapeExpression(stack1)+"/";if(helper=helpers.name){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.name;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}buffer+=escapeExpression(stack1)+'">';if(helper=helpers.name){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.name;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}buffer+=escapeExpression(stack1)+"</a>\n";return buffer})},{"handlebars/runtime":67}],96:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data){var buffer="",stack1;buffer+='\n<img src="';stack1=(stack1=(stack1=(stack1=depth0&&depth0.image,stack1==null||stack1===false?stack1:stack1[3]),stack1==null||stack1===false?stack1:stack1["#text"]),typeof stack1===functionType?stack1.apply(depth0):stack1);if(stack1||stack1===0){buffer+=stack1}buffer+='" alt="Artist image" class="cover-art">\n';return buffer}function program3(depth0,data){var buffer="",stack1;buffer+="\n<p>";stack1=(stack1=(stack1=depth0&&depth0.bio,stack1==null||stack1===false?stack1:stack1.summary),typeof stack1===functionType?stack1.apply(depth0):stack1);if(stack1||stack1===0){buffer+=stack1}buffer+="</p>\n\n<p>"+escapeExpression((stack1=(stack1=depth0&&depth0.bio,stack1==null||stack1===false?stack1:stack1.placeformed),typeof stack1===functionType?stack1.apply(depth0):stack1))+" "+escapeExpression((stack1=(stack1=depth0&&depth0.bio,stack1==null||stack1===false?stack1:stack1.yearformed),typeof stack1===functionType?stack1.apply(depth0):stack1))+"</p>\n";return buffer}stack1=helpers["if"].call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+="\n";stack1=helpers["if"].call(depth0,depth0&&depth0.bio,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+="\n";return buffer})},{"handlebars/runtime":67}],97:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};return'<ul>\n<li class="playback-controls-back" role="button">Back</li><li class="playback-controls-play" role="button">Play</li><li class="playback-controls-pause" role="button">Pause</li><li class="playback-controls-next" role="button">Next</li>\n</ul>\n'})},{"handlebars/runtime":67}],98:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};return'<input type="search">\n'})},{"handlebars/runtime":67}],99:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,functionType="function",self=this;function program1(depth0,data){var buffer="",stack1,helper;buffer+=" ";if(helper=helpers.volume){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.volume;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}if(stack1||stack1===0){buffer+=stack1}return buffer}function program3(depth0,data){return"-"}buffer+='<ul>\n<li role=button class="volume-control volume-down">Down</li><li class="volume-control volume-level">';stack1=helpers["if"].call(depth0,depth0&&depth0.volume,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+='</li><li role="button" class="volume-control volume-up">Up</li>\n</ul>\n';return buffer})},{"handlebars/runtime":67}],100:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,helper,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data){var buffer="",stack1,helper;buffer+='\n    <div class="modal-header">\n      <h1 class="modal-title">';if(helper=helpers.header){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.header;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}buffer+=escapeExpression(stack1)+"</h1>\n    </div>\n    ";return buffer}buffer+='<div class="modal-dialog">\n  <div class="modal-content">\n    ';stack1=helpers["if"].call(depth0,depth0&&depth0.header,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+='\n    <div class="modal-body">\n      ';if(helper=helpers.message){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.message;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}buffer+=escapeExpression(stack1)+"\n    </div>\n  </div>\n</div>\n";return buffer})},{"handlebars/runtime":67}],101:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};return'<p><strong>juke<span class="pink">Pi</span></strong> is connecting to the Pi in the Sky. Please hold.</p>\n'})},{"handlebars/runtime":67}],102:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};return'<header role="banner"><h1>JukePi</h1></header>\n'})},{"handlebars/runtime":67}],103:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data){var buffer="",stack1;buffer+="\n";stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.album,stack1==null||stack1===false?stack1:stack1.image),{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+="\n";return buffer}function program2(depth0,data){var buffer="",stack1;buffer+="\n";stack1=helpers["if"].call(depth0,(stack1=(stack1=depth0&&depth0.album,stack1==null||stack1===false?stack1:stack1.image),stack1==null||stack1===false?stack1:stack1[1]),{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+="\n";return buffer}function program3(depth0,data){var buffer="",stack1;buffer+="\n";stack1=helpers["if"].call(depth0,(stack1=(stack1=(stack1=depth0&&depth0.album,stack1==null||stack1===false?stack1:stack1.image),stack1==null||stack1===false?stack1:stack1[1]),stack1==null||stack1===false?stack1:stack1["#text"]),{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+="\n";return buffer}function program4(depth0,data){var buffer="",stack1,helper;buffer+='\n<img src="'+escapeExpression((stack1=(stack1=(stack1=(stack1=depth0&&depth0.album,stack1==null||stack1===false?stack1:stack1.image),stack1==null||stack1===false?stack1:stack1[1]),stack1==null||stack1===false?stack1:stack1["#text"]),typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="Cover art for '+escapeExpression((stack1=(stack1=depth0&&depth0.album,stack1==null||stack1===false?stack1:stack1.name),typeof stack1===functionType?stack1.apply(depth0):stack1))+'" class="cover-art">\n';if(helper=helpers.name){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.name;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}buffer+=escapeExpression(stack1)+"<br>"+escapeExpression((stack1=(stack1=depth0&&depth0.album,stack1==null||stack1===false?stack1:stack1.name),typeof stack1===functionType?stack1.apply(depth0):stack1))+"<br>"+escapeExpression((stack1=(stack1=depth0&&depth0.album,stack1==null||stack1===false?stack1:stack1.artist),typeof stack1===functionType?stack1.apply(depth0):stack1))+"\n";return buffer}stack1=helpers["if"].call(depth0,depth0&&depth0.album,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+="\n";return buffer})},{"handlebars/runtime":67}],104:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="";return buffer})},{"handlebars/runtime":67}],105:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data,depth1){var buffer="",stack1;buffer+='\n  <li id="tab-'+escapeExpression((stack1=depth1&&depth1.baseName,typeof stack1===functionType?stack1.apply(depth0):stack1))+"-"+escapeExpression((stack1=data==null||data===false?data:data.index,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" role="tab" aria-controls="panel-'+escapeExpression((stack1=depth1&&depth1.baseName,typeof stack1===functionType?stack1.apply(depth0):stack1))+"-"+escapeExpression((stack1=data==null||data===false?data:data.index,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" tabindex="';stack1=helpers["if"].call(depth0,data==null||data===false?data:data.first,{hash:{},inverse:self.program(4,program4,data),fn:self.program(2,program2,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+='">'+escapeExpression(typeof depth0===functionType?depth0.apply(depth0):depth0)+"</li>\n  ";return buffer}function program2(depth0,data){return"0"}function program4(depth0,data){return"-1"}buffer+='<ul role="tablist">\n  ';stack1=helpers.each.call(depth0,depth0&&depth0.tabs,{hash:{},inverse:self.noop,fn:self.programWithDepth(1,program1,data,depth0),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+="\n</ul>\n";return buffer})},{"handlebars/runtime":67}],106:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,self=this;function program1(depth0,data){return'\n<li class="interactive-list-item empty-list">No Tracks</li>\n'}stack1=helpers.unless.call(depth0,depth0&&depth0.collection,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+="\n";return buffer})},{"handlebars/runtime":67}],107:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};return'<ul class="action-toolbar">\n  <li><input type="checkbox" class="btn btn-primary"></li>\n  <li><span role="button" class="queue_selected btn btn-primary" tabindex="0">Add to queue</span></li>\n</ul>\n'})},{"handlebars/runtime":67}],108:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,helper,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data){return"current_track"}buffer+='<input type="checkbox" data-track-id="';if(helper=helpers.uri){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.uri;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}buffer+=escapeExpression(stack1)+'" tabindex="-1">\n<span class="list-item-title ';stack1=helpers["if"].call(depth0,depth0&&depth0.current,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+='">';if(helper=helpers.name){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.name;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}buffer+=escapeExpression(stack1)+'</span> <span class="list-item-artist">'+escapeExpression((stack1=(stack1=(stack1=depth0&&depth0.artists,stack1==null||stack1===false?stack1:stack1[0]),stack1==null||stack1===false?stack1:stack1.name),typeof stack1===functionType?stack1.apply(depth0):stack1))+"</span>\n";return buffer})},{"handlebars/runtime":67}],109:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,self=this;function program1(depth0,data){return'\n<li class="interactive-list-item empty-list">No Songs in Queue</li>\n'}stack1=helpers.unless.call(depth0,depth0&&depth0.collection,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+="\n";return buffer})},{"handlebars/runtime":67}],110:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};return'  <ul class="action-toolbar">\n    <li><span role="button" class="clear_queue btn btn-primary" tabindex="0">Clear Queue</span></li>\n    <li><span role="button" class="delete_selected btn btn-primary" tabindex="0">Delete Selected</span></li>\n  </ul>\n'})},{"handlebars/runtime":67}],111:[function(_dereq_,module,exports){var templater=_dereq_("handlebars/runtime").default.template;module.exports=templater(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"];helpers=this.merge(helpers,Handlebars.helpers);data=data||{};var buffer="",stack1,helper,functionType="function",escapeExpression=this.escapeExpression,self=this;function program1(depth0,data){return"current_track"}buffer+='<input type="checkbox" data-tracklist-id="';if(helper=helpers.tlid){stack1=helper.call(depth0,{hash:{},data:data})}else{helper=depth0&&depth0.tlid;stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper}buffer+=escapeExpression(stack1)+'" tabindex="-1">\n<span class="list-item-title ';stack1=helpers["if"].call(depth0,depth0&&depth0.current,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data});if(stack1||stack1===0){buffer+=stack1}buffer+='">'+escapeExpression((stack1=(stack1=depth0&&depth0.track,stack1==null||stack1===false?stack1:stack1.name),typeof stack1===functionType?stack1.apply(depth0):stack1))+'</span> <span class="list-item-artist">'+escapeExpression((stack1=(stack1=(stack1=(stack1=depth0&&depth0.track,stack1==null||stack1===false?stack1:stack1.artists),stack1==null||stack1===false?stack1:stack1[0]),stack1==null||stack1===false?stack1:stack1.name),typeof stack1===functionType?stack1.apply(depth0):stack1))+"</span>\n";return buffer})},{"handlebars/runtime":67}]},{},[1])(1)});